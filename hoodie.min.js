var requirejs,require,define;(function(){function J(a){return N.call(a)==="[object Function]"}function F(a){return N.call(a)==="[object Array]"}function Z(a,b,c){for(var e in b)!(e in K)&&(!(e in a)||c)&&(a[e]=b[e]);return d}function O(a,b,c){return a=Error(b+"\nhttp://requirejs.org/docs/errors.html#"+a),c&&(a.originalError=c),a}function $(a,b,c){var d,e,f;for(d=0;f=b[d];d++)f=typeof f=="string"?{name:f}:f,e=f.location,c&&(!e||e.indexOf("/")!==0&&e.indexOf(":")===-1)&&(e=c+"/"+(e||f.name)),a[f.name]={name:f.name,location:e||f.name,main:(f.main||"main").replace(ea,"").replace(aa,"")}}function U(a,b){a.holdReady?a.holdReady(b):b?a.readyWait+=1:a.ready(!0)}function fa(a){function b(a,b){var c,d;if(a&&a.charAt(0)===".")if(b){u.pkgs[b]?b=[b]:(b=b.split("/"),b=b.slice(0,b.length-1)),c=a=b.concat(a.split("/"));var e;for(d=0;e=c[d];d++)if(e===".")c.splice(d,1),d-=1;else if(e==="..")if(d!==1||c[2]!==".."&&c[0]!=="..")d>0&&(c.splice(d-1,2),d-=2);else break;d=u.pkgs[c=a[0]],a=a.join("/"),d&&a===c+"/"+d.main&&(a=c)}else a.indexOf("./")===0&&(a=a.substring(2));return a}function c(a,c){var d=a?a.indexOf("!"):-1,e=null,f=c?c.name:null,g=a,h,i;return d!==-1&&(e=a.substring(0,d),a=a.substring(d+1,a.length)),e&&(e=b(e,f)),a&&(e?h=(d=y[e])&&d.normalize?d.normalize(a,function(a){return b(a,f)}):b(a,f):(h=b(a,f),i=x[h],i||(i=s.nameToUrl(a,null,c),x[h]=i))),{prefix:e,name:h,parentMap:c,url:i,originalName:g,fullName:e?e+"!"+(h||""):h}}function e(){var a=!0,b=u.priorityWait,c,d;if(b){for(d=0;c=b[d];d++)if(!z[c]){a=!1;break}a&&delete u.priorityWait}return a}function f(a,b,c){return function(){var d=ga.call(arguments,0),e;return c&&J(e=d[d.length-1])&&(e.__requireJsBuild=!0),d.push(b),a.apply(null,d)}}function g(a,b,c){return b=f(c||s.require,a,b),Z(b,{nameToUrl:f(s.nameToUrl,a),toUrl:f(s.toUrl,a),defined:f(s.requireDefined,a),specified:f(s.requireSpecified,a),isBrowser:d.isBrowser}),b}function h(a){var b,e,f,g=a.callback,h=a.map,i=h.fullName,j=a.deps;f=a.listeners;if(g&&J(g)){if(u.catchError.define)try{e=d.execCb(i,a.callback,j,y[i])}catch(k){b=k}else e=d.execCb(i,a.callback,j,y[i]);i&&((g=a.cjsModule)&&g.exports!==void 0&&g.exports!==y[i]?e=y[i]=a.cjsModule.exports:e===void 0&&a.usingExports?e=y[i]:(y[i]=e,G[i]&&(I[i]=!0)))}else i&&(e=y[i]=g,G[i]&&(I[i]=!0));A[a.id]&&(delete A[a.id],a.isDone=!0,s.waitCount-=1,s.waitCount===0&&(B=[])),delete E[i],d.onResourceLoad&&!a.placeholder&&d.onResourceLoad(s,h,a.depArray);if(b)return e=(i?c(i).url:"")||b.fileName||b.sourceURL,f=b.moduleTree,b=O("defineerror",'Error evaluating module "'+i+'" at location "'+e+'":\n'+b+"\nfileName:"+e+"\nlineNumber: "+(b.lineNumber||b.line),b),b.moduleName=i,b.moduleTree=f,d.onError(b);for(b=0;g=f[b];b++)g(e)}function i(a,b){return function(c){a.depDone[b]||(a.depDone[b]=!0,a.deps[b]=c,a.depCount-=1,a.depCount||h(a))}}function j(a,b){var e=b.map,f=e.fullName,i=e.name,j=F[a]||(F[a]=y[a]),k;b.loading||(b.loading=!0,k=function(a){b.callback=function(){return a},h(b),z[b.id]=!0,t()},k.fromText=function(a,b){var c=P;z[a]=!1,s.scriptCount+=1,s.fake[a]=!0,c&&(P=!1),d.exec(b),c&&(P=!0),s.completeLoad(a)},f in y?k(y[f]):j.load(i,g(e.parentMap,!0,function(a,d){var f=[],g,h;for(g=0;h=a[g];g++)h=c(h,e.parentMap),a[g]=h.fullName,h.prefix||f.push(a[g]);return b.moduleDeps=(b.moduleDeps||[]).concat(f),s.require(a,d)}),k,u))}function k(a){A[a.id]||(A[a.id]=a,B.push(a),s.waitCount+=1)}function l(a){this.listeners.push(a)}function m(a,b){var d=a.fullName,e=a.prefix,f=e?F[e]||(F[e]=y[e]):null,g,i;return d&&(g=E[d]),!g&&(i=!0,g={id:(e&&!f?D++ +"__p@:":"")+(d||"__r@"+D++),map:a,depCount:0,depDone:[],depCallbacks:[],deps:[],listeners:[],add:l},w[g.id]=!0,d&&(!e||F[e]))&&(E[d]=g),e&&!f?(d=c(e),e in y&&!y[e]&&(delete y[e],delete C[d.url]),e=m(d,!0),e.add(function(){var b=c(a.originalName,a.parentMap),b=m(b,!0);g.placeholder=!0,b.add(function(a){g.callback=function(){return a},h(g)})})):i&&b&&(z[g.id]=!1,s.paused.push(g),k(g)),g}function n(a,b,d,e){var a=c(a,e),f=a.name,j=a.fullName,l=m(a),n=l.id,o=l.deps,p;if(j){if(j in y||z[n]===!0||j==="jquery"&&u.jQuery&&u.jQuery!==d().fn.jquery)return;w[n]=!0,z[n]=!0,j==="jquery"&&d&&V(d())}l.depArray=b,l.callback=d;for(d=0;d<b.length;d++)if(n=b[d])n=c(n,f?a:e),p=n.fullName,b[d]=p,p==="require"?o[d]=g(a):p==="exports"?(o[d]=y[j]={},l.usingExports=!0):p==="module"?l.cjsModule=o[d]={id:f,uri:f?s.nameToUrl(f,null,e):void 0,exports:y[j]}:!(p in y)||p in A||j in G&&!(j in G&&I[p])?(j in G&&(G[p]=!0,delete y[p],C[n.url]=!1),l.depCount+=1,l.depCallbacks[d]=i(l,d),m(n,!0).add(l.depCallbacks[d])):o[d]=y[p];l.depCount?k(l):h(l)}function o(a){n.apply(null,a)}function p(a,b){var c=a.map.fullName,d=a.depArray,e=!0,f,g,h,i;if(a.isDone||!c||!z[c])return i;if(b[c])return a;b[c]=!0;if(d){for(f=0;f<d.length;f++){g=d[f];if(!z[g]&&!ha[g]){e=!1;break}if((h=A[g])&&!h.isDone&&z[g])if(i=p(h,b))break}e||(i=void 0,delete b[c])}return i}function q(a,b){var d=a.map.fullName,e=a.depArray,f,g,h,i;if(!a.isDone&&d&&z[d]){if(d){if(b[d])return y[d];b[d]=!0}if(e)for(f=0;f<e.length;f++)if(g=e[f])if((h=c(g).prefix)&&(i=A[h])&&q(i,b),(h=A[g])&&!h.isDone&&z[g])g=q(h,b),a.depCallbacks[f](g);return y[d]}}function r(){var a=u.waitSeconds*1e3,a=a&&s.startTime+a<(new Date).getTime(),b="",c=!1,f=!1,g=[],h,i;if(!(s.pausedCount>0)){if(u.priorityWait)if(e())t();else return;for(h in z)if(!(h in K)&&(c=!0,!z[h]))if(a)b+=h+" ";else{if(f=!0,h.indexOf("!")===-1){g=[];break}(i=E[h]&&E[h].moduleDeps)&&g.push.apply(g,i)}if(c||s.waitCount){if(a&&b)return a=O("timeout","Load timeout for modules: "+b),a.requireType="timeout",a.requireModules=b,a.contextName=s.contextName,d.onError(a);if(f&&g.length)for(b=0;h=A[g[b]];b++)if(h=p(h,{})){q(h,{});break}if(!a&&(f||s.scriptCount))(H||ca)&&!W&&(W=setTimeout(function(){W=0,r()},50));else{if(s.waitCount){for(b=0;h=B[b];b++)q(h,{});s.paused.length&&t(),X<5&&(X+=1,r())}X=0,d.checkReadyState()}}}}var s,t,u={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},catchError:{}},v=[],w={require:!0,exports:!0,module:!0},x={},y={},z={},A={},B=[],C={},D=0,E={},F={},G={},I={},L=0;return V=function(a){!s.jQuery&&(a=a||(typeof jQuery!="undefined"?jQuery:null))&&(!u.jQuery||a.fn.jquery===u.jQuery)&&("holdReady"in a||"readyWait"in a)&&(s.jQuery=a,o(["jquery",[],function(){return jQuery}]),s.scriptCount)&&(U(a,!0),s.jQueryIncremented=!0)},t=function(){var a,b,c,f,g,h;s.takeGlobalQueue(),L+=1,s.scriptCount<=0&&(s.scriptCount=0);for(;v.length;){if(a=v.shift(),a[0]===null)return d.onError(O("mismatch","Mismatched anonymous define() module: "+a[a.length-1]));o(a)}if(!u.priorityWait||e())for(;s.paused.length;){g=s.paused,s.pausedCount+=g.length,s.paused=[];for(f=0;a=g[f];f++)b=a.map,c=b.url,h=b.fullName,b.prefix?j(b.prefix,a):!C[c]&&!z[h]&&(d.load(s,h,c),c.indexOf("empty:")!==0&&(C[c]=!0));s.startTime=(new Date).getTime(),s.pausedCount-=g.length}L===1&&r(),L-=1},s={contextName:a,config:u,defQueue:v,waiting:A,waitCount:0,specified:w,loaded:z,urlMap:x,urlFetched:C,scriptCount:0,defined:y,paused:[],pausedCount:0,plugins:F,needFullExec:G,fake:{},fullExec:I,managerCallbacks:E,makeModuleMap:c,normalize:b,configure:function(a){var b,c,d;a.baseUrl&&a.baseUrl.charAt(a.baseUrl.length-1)!=="/"&&(a.baseUrl+="/"),b=u.paths,d=u.pkgs,Z(u,a,!0);if(a.paths){for(c in a.paths)c in K||(b[c]=a.paths[c]);u.paths=b}if((b=a.packagePaths)||a.packages){if(b)for(c in b)c in K||$(d,b[c],c);a.packages&&$(d,a.packages),u.pkgs=d}a.priority&&(c=s.requireWait,s.requireWait=!1,t(),s.require(a.priority),t(),s.requireWait=c,u.priorityWait=a.priority),(a.deps||a.callback)&&s.require(a.deps||[],a.callback)},requireDefined:function(a,b){return c(a,b).fullName in y},requireSpecified:function(a,b){return c(a,b).fullName in w},require:function(b,e,f){if(typeof b=="string")return J(e)?d.onError(O("requireargs","Invalid require call")):d.get?d.get(s,b,e):(e=c(b,e),b=e.fullName,b in y?y[b]:d.onError(O("notloaded","Module name '"+e.fullName+"' has not been loaded yet for context: "+a)));(b&&b.length||e)&&n(null,b,e,f);if(!s.requireWait)for(;!s.scriptCount&&s.paused.length;)t();return s.require},takeGlobalQueue:function(){T.length&&(ia.apply(s.defQueue,[s.defQueue.length-1,0].concat(T)),T=[])},completeLoad:function(a){var b;for(s.takeGlobalQueue();v.length;){if(b=v.shift(),b[0]===null){b[0]=a;break}if(b[0]===a)break;o(b),b=null}b?o(b):o([a,[],a==="jquery"&&typeof jQuery!="undefined"?function(){return jQuery}:null]),d.isAsync&&(s.scriptCount-=1),t(),d.isAsync||(s.scriptCount-=1)},toUrl:function(a,b){var c=a.lastIndexOf("."),d=null;return c!==-1&&(d=a.substring(c,a.length),a=a.substring(0,c)),s.nameToUrl(a,d,b)},nameToUrl:function(a,c,e){var f,g,h,i,j=s.config,a=b(a,e&&e.fullName);if(d.jsExtRegExp.test(a))c=a+(c?c:"");else{f=j.paths,g=j.pkgs,e=a.split("/");for(i=e.length;i>0;i--){if(h=e.slice(0,i).join("/"),f[h]){e.splice(0,i,f[h]);break}if(h=g[h]){a=a===h.name?h.location+"/"+h.main:h.location,e.splice(0,i,a);break}}c=e.join("/")+(c||".js"),c=(c.charAt(0)==="/"||c.match(/^\w+:/)?"":j.baseUrl)+c}return j.urlArgs?c+((c.indexOf("?")===-1?"?":"&")+j.urlArgs):c}},s.jQueryCheck=V,s.resume=t,s}function ja(){var a,b,c;if(B&&B.readyState==="interactive")return B;a=document.getElementsByTagName("script");for(b=a.length-1;b>-1&&(c=a[b]);b--)if(c.readyState==="interactive")return B=c;return null}var ka=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,la=/require\(\s*["']([^'"\s]+)["']\s*\)/g,ea=/^\.\//,aa=/\.js$/,N=Object.prototype.toString,t=Array.prototype,ga=t.slice,ia=t.splice,H=typeof window!="undefined"&&!!navigator&&!!document,ca=!H&&typeof importScripts!="undefined",ma=H&&navigator.platform==="PLAYSTATION 3"?/^complete$/:/^(complete|loaded)$/,da=typeof opera!="undefined"&&opera.toString()==="[object Opera]",K={},C={},T=[],B=null,X=0,P=!1,ha={require:!0,module:!0,exports:!0},d,t={},I,x,u,D,o,v,E,A,y,V,W;if(typeof define=="undefined"){if(typeof requirejs!="undefined"){if(J(requirejs))return;t=requirejs,requirejs=void 0}typeof require!="undefined"&&!J(require)&&(t=require,require=void 0),d=requirejs=function(a,b,c){var d="_",e;return!F(a)&&typeof a!="string"&&(e=a,F(b)?(a=b,b=c):a=[]),e&&e.context&&(d=e.context),c=C[d]||(C[d]=fa(d)),e&&c.configure(e),c.require(a,b)},d.config=function(a){return d(a)},require||(require=d),d.toUrl=function(a){return C._.toUrl(a)},d.version="1.0.7",d.jsExtRegExp=/^\/|:|\?|\.js$/,x=d.s={contexts:C,skipAsync:{}};if(d.isAsync=d.isBrowser=H)if(u=x.head=document.getElementsByTagName("head")[0],D=document.getElementsByTagName("base")[0])u=x.head=D.parentNode;d.onError=function(a){throw a},d.load=function(a,b,c){d.resourcesReady(!1),a.scriptCount+=1,d.attach(c,a,b),a.jQuery&&!a.jQueryIncremented&&(U(a.jQuery,!0),a.jQueryIncremented=!0)},define=function(a,b,c){var d,e;typeof a!="string"&&(c=b,b=a,a=null),F(b)||(c=b,b=[]),!b.length&&J(c)&&c.length&&(c.toString().replace(ka,"").replace(la,function(a,c){b.push(c)}),b=(c.length===1?["require"]:["require","exports","module"]).concat(b)),P&&(d=I||ja())&&(a||(a=d.getAttribute("data-requiremodule")),e=C[d.getAttribute("data-requirecontext")]),(e?e.defQueue:T).push([a,b,c])},define.amd={multiversion:!0,plugins:!0,jQuery:!0},d.exec=function(a){return eval(a)},d.execCb=function(a,b,c,d){return b.apply(d,c)},d.addScriptToDom=function(a){I=a,D?u.insertBefore(a,D):u.appendChild(a),I=null},d.onScriptLoad=function(a){var b=a.currentTarget||a.srcElement,c;if(a.type==="load"||b&&ma.test(b.readyState))B=null,a=b.getAttribute("data-requirecontext"),c=b.getAttribute("data-requiremodule"),C[a].completeLoad(c),b.detachEvent&&!da?b.detachEvent("onreadystatechange",d.onScriptLoad):b.removeEventListener("load",d.onScriptLoad,!1)},d.attach=function(a,b,c,e,f,g){var h;return H?(e=e||d.onScriptLoad,h=b&&b.config&&b.config.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script"),h.type=f||b&&b.config.scriptType||"text/javascript",h.charset="utf-8",h.async=!x.skipAsync[a],b&&h.setAttribute("data-requirecontext",b.contextName),h.setAttribute("data-requiremodule",c),h.attachEvent&&!da?(P=!0,g?h.onreadystatechange=function(){h.readyState==="loaded"&&(h.onreadystatechange=null,h.attachEvent("onreadystatechange",e),g(h))}:h.attachEvent("onreadystatechange",e)):h.addEventListener("load",e,!1),h.src=a,g||d.addScriptToDom(h),h):(ca&&(importScripts(a),b.completeLoad(c)),null)};if(H){o=document.getElementsByTagName("script");for(A=o.length-1;A>-1&&(v=o[A]);A--){u||(u=v.parentNode);if(E=v.getAttribute("data-main")){t.baseUrl||(o=E.split("/"),v=o.pop(),o=o.length?o.join("/")+"/":"./",t.baseUrl=o,E=v.replace(aa,"")),t.deps=t.deps?t.deps.concat(E):[E];break}}}d.checkReadyState=function(){var a=x.contexts,b;for(b in a)if(!(b in K)&&a[b].waitCount)return;d.resourcesReady(!0)},d.resourcesReady=function(a){var b,c;d.resourcesDone=a;if(d.resourcesDone)for(c in a=x.contexts,a)!(c in K)&&(b=a[c],b.jQueryIncremented)&&(U(b.jQuery,!1),b.jQueryIncremented=!1)},d.pageLoaded=function(){document.readyState!=="complete"&&(document.readyState="complete")},H&&document.addEventListener&&!document.readyState&&(document.readyState="loading",window.addEventListener("load",d.pageLoaded,!1)),d(t),d.isAsync&&typeof setTimeout!="undefined"&&(y=x.contexts[t.context||"_"],y.requireWait=!0,setTimeout(function(){y.requireWait=!1,y.scriptCount||y.resume(),d.checkReadyState()},0))}})(),define("requireLib",function(){});var __slice=[].slice;define("hoodie/events",[],function(){var a;return a=function(){function a(){}return a.name="Events",a.prototype.bind=function(a,b){var c,d,e,f,g,h;d=a.split(" "),c=this.hasOwnProperty("_callbacks")&&this._callbacks||(this._callbacks={}),h=[];for(f=0,g=d.length;f<g;f++)e=d[f],c[e]||(c[e]=[]),h.push(c[e].push(b));return h},a.prototype.on=a.prototype.bind,a.prototype.one=function(a,b){return this.bind(a,function(){return this.unbind(a,arguments.callee),b.apply(this,arguments)})},a.prototype.trigger=function(){var a,b,c,d,e,f,g;a=1<=arguments.length?__slice.call(arguments,0):[],c=a.shift(),d=this.hasOwnProperty("_callbacks")&&((g=this._callbacks)!=null?g[c]:void 0);if(!d)return;for(e=0,f=d.length;e<f;e++)b=d[e],b.apply(this,a);return!0},a.prototype.unbind=function(a,b){var c,d,e,f,g,h;if(!a)return this._callbacks={},this;e=(h=this._callbacks)!=null?h[a]:void 0;if(!e)return this;if(!b)return delete this._callbacks[a],this;for(d=f=0,g=e.length;f<g;d=++f){c=e[d];if(c!==b)continue;e=e.slice(),e.splice(d,1),this._callbacks[a]=e;break}return this},a}()}),define("hoodie/errors",[],function(){var a;return a={INVALID_KEY:function(a){var b;return b=a.id?"id":"type",new Error("invalid "+b+" '"+a[b]+"': numbers and lowercase letters allowed only")},INVALID_ARGUMENTS:function(a){return new Error(a)},NOT_FOUND:function(a,b){return new Error(""+a+" with "+b+" could not be found")}}});var __bind=function(a,b){return function(){return a.apply(b,arguments)}};define("hoodie/store",["hoodie/errors"],function(a){var b;return b=function(){function b(a){this.hoodie=a,this.clear=__bind(this.clear,this),this.is_persistent()||(this.db={getItem:function(){return null},setItem:function(){return null},removeItem:function(){return null},key:function(){return null},length:function(){return 0},clear:function(){return null}}),this.hoodie.on("account:signed_out",this.clear)}return b.name="Store",b.prototype.db={getItem:function(a){return window.localStorage.getItem(a)},setItem:function(a,b){return window.localStorage.setItem(a,b)},removeItem:function(a){return window.localStorage.removeItem(a)},key:function(a){return window.localStorage.key(a)},length:function(){return window.localStorage.length},clear:function(){return window.localStorage.clear()}},b.prototype.save=function(b,c,d,e){var f,g;e==null&&(e={}),f=this.hoodie.defer();if(typeof d!="object")return f.reject(a.INVALID_ARGUMENTS("object is "+typeof d)),f.promise();d=$.extend({},d),c?g=typeof this._cached[""+b+"/"+c]!="object":(g=!0,c=this.uuid());if(!this._is_valid_id(c))return f.reject(a.INVALID_KEY({id:c})).promise();if(!this._is_valid_type(b))return f.reject(a.INVALID_KEY({type:b})).promise();e.remote?d._synced_at=this._now():(d.updated_at=this._now(),d.created_at||(d.created_at=d.updated_at)),delete d.id,delete d.type;try{d=this.cache(b,c,d,e),f.resolve(d,g).promise()}catch(h){f.reject(h).promise()}return f.promise()},b.prototype.create=function(a,b,c){return c==null&&(c={}),this.save(a,void 0,b)},b.prototype.update=function(a,b,c,d){var e=this;return d==null&&(d={}),this.load(a,b).pipe(function(d){return e.save(a,b,$.extend(d,c))})},b.prototype.load=function(b,c){var d,e;d=this.hoodie.defer();if(typeof b!="string"||typeof c!="string")return d.reject(a.INVALID_ARGUMENTS("type & id are required")).promise();try{e=this.cache(b,c);if(!e)return d.reject(a.NOT_FOUND(b,c)).promise();d.resolve(e)}catch(f){d.reject(f)}return d.promise()},b.prototype.loadAll=function(a,b){var c,d,e,f,g,h,i;c=this.hoodie.defer(),f=this._index();try{h=function(){var c,h,j,k,l,m,n,o,p,q,r,s;switch(!0){case a!=null&&b!=null:q=[];for(c=0,k=f.length;c<k;c++){e=f[c];if(e.indexOf(a)!==0||!this._is_semantic_id(e))continue;n=e.split("/"),i=n[0],d=n[1],g=this.cache(i,d);if(b(g))q.push(g);else continue}return q;case a!=null:r=[];for(h=0,l=f.length;h<l;h++){e=f[h];if(e.indexOf(a)!==0||!this._is_semantic_id(e))continue;o=e.split("/"),i=o[0],d=o[1],r.push(this.cache(i,d))}return r;default:s=[];for(j=0,m=f.length;j<m;j++){e=f[j];if(!this._is_semantic_id(e))continue;p=e.split("/"),i=p[0],d=p[1],s.push(this.cache(i,d))}return s}}.call(this),c.resolve(h).promise()}catch(j){c.reject(j).promise()}return c.promise()},b.prototype["delete"]=function(b,c,d){var e,f,g;return d==null&&(d={}),e=this.hoodie.defer(),g=this.cache(b,c),g?(g._synced_at&&!d.remote?(g._deleted=!0,this.cache(b,c,g)):(f=""+b+"/"+c,this.db.removeItem(f),this._cached[f]=!1,this.clear_changed(b,c)),e.resolve($.extend({},g))):e.reject(a.NOT_FOUND(b,c)).promise()},b.prototype.destroy=b.prototype["delete"],b.prototype.cache=function(a,b,c,d){var e;c==null&&(c=!1),d==null&&(d={}),e=""+a+"/"+b;if(c){this._cached[e]=$.extend(c,{type:a,id:b}),this._setObject(a,b,c);if(d.remote)return this.clear_changed(a,b),$.extend({},this._cached[e])}else{if(this._cached[e]!=null)return $.extend({},this._cached[e]);this._cached[e]=this._getObject(a,b)}return this._cached[e]&&(this._is_dirty(this._cached[e])||this._is_marked_as_deleted(this._cached[e]))?this.mark_as_changed(a,b,this._cached[e]):this.clear_changed(a,b),this._cached[e]?$.extend({},this._cached[e]):this._cached[e]},b.prototype.clear_changed=function(a,b){var c;return a&&b?(c=""+a+"/"+b,delete this._dirty[c]):this._dirty={},this.hoodie.trigger("store:dirty")},b.prototype.is_marked_as_deleted=function(a,b){return this._is_marked_as_deleted(this.cache(a,b))},b.prototype.mark_as_changed=function(a,b,c){var d,e,f=this;return d=""+a+"/"+b,this._dirty[d]=c,this.hoodie.trigger("store:dirty"),e=2e3,window.clearTimeout(this._dirty_timeout),this._dirty_timeout=window.setTimeout(function(){return f.hoodie.trigger("store:dirty:idle")},e)},b.prototype.changed_docs=function(){var a,b,c,d;c=this._dirty,d=[];for(a in c)b=c[a],d.push(b);return d},b.prototype.is_dirty=function(a,b){return a?this._is_dirty(this.cache(a,b)):$.isEmptyObject(this._dirty)},b.prototype.clear=function(){var a;a=this.hoodie.defer();try{this.db.clear(),this._cached={},this.clear_changed(),a.resolve()}catch(b){a.reject(b)}return a.promise()},b.prototype.is_persistent=function(){try{if(!window.localStorage)return!1;localStorage.setItem("Storage-Test","1");if(localStorage.getItem("Storage-Test")!=="1")return!1;localStorage.removeItem("Storage-Test")}catch(a){return!1}return!0},b.prototype.uuid=function(a){var b,c,d;return a==null&&(a=7),b="0123456789abcdefghijklmnopqrstuvwxyz".split(""),d=b.length,function(){var e,f;f=[];for(c=e=0;0<=a?e<a:e>a;c=0<=a?++e:--e)f.push(b[0|Math.random()*d]);return f}().join("")},b.prototype._setObject=function(a,b,c){var d,e;return d=""+a+"/"+b,e=$.extend({},c),delete e.type,delete e.id,this.db.setItem(d,JSON.stringify(e))},b.prototype._getObject=function(a,b){var c,d,e;return d=""+a+"/"+b,c=this.db.getItem(d),c?(e=JSON.parse(c),e.type=a,e.id=b,e.created_at&&(e.created_at=new Date(Date.parse(e.created_at))),e.updated_at&&(e.updated_at=new Date(Date.parse(e.updated_at))),e._synced_at&&(e._synced_at=new Date(Date.parse(e._synced_at))),e):!1},b.prototype._now=function(){return new Date},b.prototype._is_valid_id=function(a){return/^[a-z0-9]+$/.test(a)},b.prototype._is_valid_type=function(a){return/^[a-z$][a-z0-9]+$/.test(a)},b.prototype._is_semantic_id=function(a){return/^[a-z$][a-z0-9]+\/[a-z0-9]+$/.test(a)},b.prototype._cached={},b.prototype._dirty={},b.prototype._is_dirty=function(a){return a._synced_at?a.updated_at?a._synced_at.getTime()<a.updated_at.getTime():!1:!0},b.prototype._is_marked_as_deleted=function(a){return a._deleted===!0},b.prototype._index=function(){var a,b,c,d;d=[];for(a=b=0,c=this.db.length();0<=c?b<c:b>c;a=0<=c?++b:--b)d.push(this.db.key(a));return d},b}()});var __bind=function(a,b){return function(){return a.apply(b,arguments)}};define("hoodie/account",[],function(){var a;return a=function(){function a(a){this.hoodie=a,this._handle_sign_out=__bind(this._handle_sign_out,this),this._handle_sign_in=__bind(this._handle_sign_in,this),this.email=this.hoodie.store.db.getItem("_couch.account.email"),this.authenticate(),this.on("signed_in",this._handle_sign_in),this.on("signed_out",this._handle_sign_out)}return a.name="Account",a.prototype.email=void 0,a.prototype.authenticate=function(){var a,b=this;return a=this.hoodie.defer(),this.email?this._authenticated===!0?a.resolve(this.email).promise():this._authenticated===!1?a.reject().promise():(this.hoodie.request("GET","/_session",{success:function(c){return c.userCtx.name?(b._authenticated=!0,b.email=c.userCtx.name,a.resolve(b.email)):(b._authenticated=!1,b.hoodie.trigger("account:error:unauthenticated"),a.reject())},error:function(b){var c;try{c=JSON.parse(b.responseText)}catch(d){c={error:b.responseText||"unknown"}}return a.reject(c)}}),a.promise()):a.reject().promise()},a.prototype.sign_up=function(a,b,c){var d,e,f,g=this;return c==null&&(c={}),e=this.hoodie.defer(),f=""+this._prefix+":"+a,d={_id:f,name:a,type:"user",roles:[],user_data:c,password:b},this.hoodie.request("PUT","/_users/"+encodeURIComponent(f),{data:JSON.stringify(d),contentType:"application/json",success:function(b){return g.hoodie.trigger("account:signed_up",a),g.hoodie.trigger("account:signed_in",a),g.fetch(),e.resolve(a)},error:function(a){var b;try{b=JSON.parse(a.responseText)}catch(c){b={error:a.responseText||"unknown"}}return e.reject(b)}}),e.promise()},a.prototype.sign_in=function(a,b){var c,d=this;return c=this.hoodie.defer(),this.hoodie.request("POST","/_session",{data:{name:a,password:b},success:function(){return d.hoodie.trigger("account:signed_in",a),d.fetch(),c.resolve(a)},error:function(a){var b;try{b=JSON.parse(a.responseText)}catch(d){b={error:a.responseText||"unknown"}}return c.reject(b)}}),c.promise()},a.prototype.login=a.prototype.sign_in,a.prototype.change_password=function(a,b){var c,d,e,f=this;return d=this.hoodie.defer(),this.email?(e=""+this._prefix+":"+this.email,c=$.extend({},this._doc),delete c.salt,delete c.password_sha,c.password=b,this.hoodie.request("PUT","/_users/"+encodeURIComponent(e),{data:JSON.stringify(c),contentType:"application/json",success:function(a){return f.fetch(),d.resolve()},error:function(a){var b;try{b=JSON.parse(a.responseText)}catch(c){b={error:a.responseText||"unknown"}}return d.reject(b)}})):(d.reject({error:"unauthenticated",reason:"not logged in"}),d.promise())},a.prototype.sign_out=function(){var a=this;return this.hoodie.request("DELETE","/_session",{success:function(){return a.hoodie.trigger("account:signed_out")}})},a.prototype.logout=a.prototype.sign_out,a.prototype.on=function(a,b){return this.hoodie.on("account:"+a,b)},a.prototype.db=function(){var a;return(a=this.email)!=null?a.toLowerCase().replace(/@/,"$").replace(/\./g,"_"):void 0},a.prototype.fetch=function(){var a,b,c=this;return a=this.hoodie.defer(),this.email?(b=""+this._prefix+":"+this.email,this.hoodie.request("GET","/_users/"+encodeURIComponent(b),{success:function(b){return c._doc=b,a.resolve(b)},error:function(b){var c;try{c=JSON.parse(b.responseText)}catch(d){c={error:b.responseText||"unknown"}}return a.reject(c)}}),a.promise()):(a.reject({error:"unauthenticated",reason:"not logged in"}),a.promise())},a.prototype.user_data=function(){var a;return(a=this._doc)!=null?a.user_data:void 0},a.prototype._prefix="org.couchdb.user",a.prototype._doc={},a.prototype._handle_sign_in=function(a){return this.email=a,this.hoodie.store.db.setItem("_couch.account.email",this.email),this._authenticated=!0},a.prototype._handle_sign_out=function(){return delete this.email,this.hoodie.store.db.removeItem("_couch.account.email"),this._authenticated=!1},a}()});var __bind=function(a,b){return function(){return a.apply(b,arguments)}};define("hoodie/remote",["hoodie/errors"],function(a){var b;return b=function(){function a(a){this.hoodie=a,this._handle_push_changes=__bind(this._handle_push_changes,this),this._handle_pull_changes=__bind(this._handle_pull_changes,this),this._changes_error=__bind(this._changes_error,this),this._changes_success=__bind(this._changes_success,this),this._restart_changes_request=__bind(this._restart_changes_request,this),this.push_changes=__bind(this.push_changes,this),this.pull_changes=__bind(this.pull_changes,this),this.disconnect=__bind(this.disconnect,this),this.connect=__bind(this.connect,this),this.hoodie.on("account:signed_in",this.connect),this.hoodie.on("account:signed_out",this.disconnect),this.hoodie.account.authenticate().then(this.connect)}return a.name="Remote",a.prototype.connect=function(){if(this._connected)return;return this.hoodie.on("store:dirty:idle",this.push_changes),this.pull_changes(),this.push_changes()},a.prototype.disconnect=function(){var a;return this._connected=!1,(a=this._changes_request)!=null&&a.abort(),this.reset_seq(),this.hoodie.unbind("store:dirty:idle",this.push_changes)},a.prototype.pull_changes=function(){return this._connected=!0,this._changes_request=this.hoodie.request("GET",this._changes_path(),{success:this._changes_success,error:this._changes_error}),window.clearTimeout(this._changes_request_timeout),this._changes_request_timeout=window.setTimeout(this._restart_changes_request,25e3)},a.prototype.push_changes=function(){var a,b;return b=this.hoodie.store.changed_docs(),b.length===0?this._promise().resolve([]):(b=function(){var c,d,e;e=[];for(c=0,d=b.length;c<d;c++)a=b[c],e.push(this._parse_for_remote(a));return e}.call(this),this.hoodie.request("POST","/"+encodeURIComponent(this.hoodie.account.db())+"/_bulk_docs",{dataType:"json",processData:!1,contentType:"application/json",data:JSON.stringify({docs:b}),success:this._handle_push_changes}))},a.prototype.get_seq=function(){return this._seq||(this._seq=this.hoodie.store.db.getItem("_couch.remote.seq")||0)},a.prototype.set_seq=function(a){return this._seq=this.hoodie.store.db.setItem("_couch.remote.seq",a)},a.prototype.reset_seq=function(){return this.hoodie.store.db.removeItem("_couch.remote.seq"),delete this._seq},a.prototype.on=function(a,b){return this.hoodie.on("remote:"+a,b)},a.prototype._changes_path=function(){var a;return a=this.get_seq(),"/"+encodeURIComponent(this.hoodie.account.db())+"/_changes?include_docs=true&heartbeat=10000&feed=longpoll&since="+a},a.prototype._restart_changes_request=function(){var a;return(a=this._changes_request)!=null?a.abort():void 0},a.prototype._changes_success=function(a){if(!this._connected)return;return this.set_seq(a.last_seq),this._handle_pull_changes(a.results),this.pull_changes()},a.prototype._changes_error=function(a,b,c){if(!this._connected)return;switch(a.status){case 403:return this.hoodie.trigger("remote:error:unauthenticated"),this.disconnect();case 404:return window.setTimeout(this.pull_changes,3e3);case 500:return this.hoodie.trigger("remote:error:server"),window.setTimeout(this.pull_changes,3e3);default:return a.statusText==="abort"?this.pull_changes():window.setTimeout(this.pull_changes,3e3)}},a.prototype._valid_special_attributes={_id:1,_rev:1,_deleted:1},a.prototype._parse_for_remote=function(a){var b,c;c=$.extend({},a);for(b in c){if(this._valid_special_attributes[b])continue;if(!/^_/.test(b))continue;delete c[b]}return c._id=""+c.type+"/"+c.id,delete c.id,c},a.prototype._parse_from_remote=function(a){var b,c;return b=a._id||a.id,delete a._id,b===void 0&&(console.log("obj"),console.log(JSON.stringify(a))),c=b.split(/\//),a.type=c[0],a.id=c[1],a.created_at&&(a.created_at=new Date(Date.parse(a.created_at))),a.updated_at&&(a.updated_at=new Date(Date.parse(a.updated_at))),a},a.prototype._handle_pull_changes=function(a){var b,c,d,e,f,g=this;f=[];for(d=0,e=a.length;d<e;d++)b=a[d].doc,c=this._parse_from_remote(b),c._deleted?f.push(this.hoodie.store.destroy(c.type,c.id,{remote:!0}).then(function(a){return g.hoodie.trigger("remote:destroyed",c.type,c.id,a),g.hoodie.trigger("remote:destroyed:"+c.type,c.id,a),g.hoodie.trigger("remote:destroyed:"+c.type+":"+c.id,a),g.hoodie.trigger("remote:changed","destroyed",c.type,c.id,a),g.hoodie.trigger("remote:changed:"+c.type,"destroyed",c.id,a),g.hoodie.trigger("remote:changed:"+c.type+":"+c.id,"destroyed",a)})):f.push(this.hoodie.store.save(c.type,c.id,c,{remote:!0}).then(function(a,b){return b?(g.hoodie.trigger("remote:created",c.type,c.id,a),g.hoodie.trigger("remote:created:"+c.type,c.id,a),g.hoodie.trigger("remote:created:"+c.type+":"+c.id,a),g.hoodie.trigger("remote:changed","created",c.type,c.id,a),g.hoodie.trigger("remote:changed:"+c.type,"created",c.id,a),g.hoodie.trigger("remote:changed:"+c.type+":"+c.id,"created",a)):(g.hoodie.trigger("remote:updated",c.type,c.id,a),g.hoodie.trigger("remote:updated:"+c.type,c.id,a),g.hoodie.trigger("remote:updated:"+c.type+":"+c.id,a),g.hoodie.trigger("remote:changed","updated",c.type,c.id,a),g.hoodie.trigger("remote:changed:"+c.type,"updated",c.id,a),g.hoodie.trigger("remote:changed:"+c.type+":"+c.id,"updated",a))}));return f},a.prototype._handle_push_changes=function(a){var b,c,d,e;e=[];for(c=0,d=a.length;c<d;c++)b=a[c],b.error==="conflict"&&e.push(this.hoodie.trigger("remote:error:conflict",b.id));return e},a.prototype._promise=$.Deferred,a}()});var __bind=function(a,b){return function(){return a.apply(b,arguments)}};define("hoodie/email",[],function(){var a;return a=function(){function a(a){this.hoodie=a,this._handle_email_update=__bind(this._handle_email_update,this)}return a.name="Email",a.prototype.send=function(a){var b,c,d=this;return a==null&&(a={}),c=this.hoodie.defer(),b=$.extend({},a),this._is_valid_email(a.to)?(this.hoodie.store.create("$email",b).then(function(a){return d._handle_email_update(c,a)}),c.promise()):(b.error="Invalid email address ("+(b.to||"empty")+")",c.reject(b).promise())},a.prototype._is_valid_email=function(a){return a==null&&(a=""),/@/.test(a)},a.prototype._handle_email_update=function(a,b){var c=this;return b==null&&(b={}),b.error?a.reject(b):b.delivered_at?a.resolve(b):this.hoodie.one("remote:updated:$email:"+b.id,function(b){return c._handle_email_update(a,b)})},a}()}),define("hoodie/sharing",[],function(){var a;return a=function(){function a(a){this.hoodie=a}return a.name="Sharing",a.prototype.create=function(a){var b,c=this;return b=this.hoodie.defer(),a.invitees!=null&&(a["private"]=!0),a.filter=this._turn_filters_into_function(a.filters),delete a.filters,this.hoodie.store.save("$sharing",a.id,a).done(function(a){return c.hoodie.one("remote:created:$sharing:"+a.id,b.resolve)}),b.promise()},a.prototype.destroy=function(a){return this.hoodie.store.destroy("$sharing",a)},a.prototype["delete"]=a.prototype.destroy,a.prototype._turn_filters_into_function=function(a){var b,c,d,e,f,g,h;if(!a)return;b=[];for(g=0,h=a.length;g<h;g++){d=a[g],c=[];for(e in d){f=d[e];if(/'/.test(""+e+f))continue;typeof f=="string"?c.push("obj['"+e+"'] == '"+f+"'"):c.push("obj['"+e+"'] == "+f)}b.push(c.join(" && "))}return"function(obj) { return "+b.join(" || ")+" }"},a}()}),define("hoodie/config",[],function(){var a;return a=function(){function a(a){this.hoodie=a}return a.name="Config",a}()});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function d(){this.constructor=a}for(var c in b)__hasProp.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};define("hoodie",["hoodie/events","hoodie/store","hoodie/account","hoodie/remote","hoodie/email","hoodie/sharing","hoodie/config"],function(a,b,c,d,e,f,g){var h;return h=function(a){function g(a){this.base_url=a!=null?a:"",this.base_url=this.base_url.replace(/\/+$/,""),this.store=new b(this),this.account=new c(this),this.remote=new d(this),this.email=new e(this),this.sharing=new f(this)}return __extends(g,a),g.name="Hoodie",g.prototype.request=function(a,b,c){var d;return c==null&&(c={}),d={type:a,url:""+this.base_url+b,xhrFields:{withCredentials:!0},crossDomain:!0,dataType:"json"},$.ajax($.extend(d,c))},g.prototype.defer=$.Deferred,g}(a)})