// Hoodie.js - 0.9.6
// https://github.com/hoodiehq/hoodie.js
// Copyright 2012 - 2014 https://github.com/hoodiehq/
// Licensed Apache License 2.0

!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.Hoodie=a()}}(function(){var a,b,c;return function d(a,b,c){function e(g,h){if(!b[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=b[g]={exports:{}};a[g][0].call(j.exports,function(b){var c=a[g][1][b];return e(c?c:b)},j,j.exports,d,a,b,c)}return b[g].exports}for(var f="function"==typeof require&&require,g=0;g<c.length;g++)e(c[g]);return e}({1:[function(a,b){"use strict";b.exports=function(a){function b(a){var b=new c(a),d=b.promise();return d.isRejected()?d:(b.setHowMany(1),b.setUnwrap(),b.init(),d)}var c=a._SomePromiseArray;a.any=function(a){return b(a)},a.prototype.any=function(){return b(this)}}},{}],2:[function(a,b){(function(c){"use strict";function d(){this._isTickUsed=!1,this._schedule=e,this._length=0,this._lateBuffer=new f(16),this._functionBuffer=new f(65536);var a=this;this.consumeFunctionBuffer=function(){a._consumeFunctionBuffer()}}var e=a("./schedule.js"),f=a("./queue.js"),g=a("./util.js").errorObj,h=a("./util.js").tryCatch1,i="undefined"!=typeof c?c:void 0;d.prototype.haveItemsQueued=function(){return this._length>0},d.prototype.invokeLater=function(a,b,c){void 0===i||null==i.domain||a.domain||(a=i.domain.bind(a)),this._lateBuffer.push(a,b,c),this._queueTick()},d.prototype.invoke=function(a,b,c){void 0===i||null==i.domain||a.domain||(a=i.domain.bind(a));var d=this._functionBuffer;d.push(a,b,c),this._length=d.length(),this._queueTick()},d.prototype._consumeFunctionBuffer=function(){for(var a=this._functionBuffer;a.length()>0;){var b=a.shift(),c=a.shift(),d=a.shift();b.call(c,d)}this._reset(),this._consumeLateBuffer()},d.prototype._consumeLateBuffer=function(){for(var a=this._lateBuffer;a.length()>0;){var b=a.shift(),c=a.shift(),d=a.shift(),e=h(b,c,d);if(e===g){if(this._queueTick(),null==b.domain)throw e.e;b.domain.emit("error",e.e)}}},d.prototype._queueTick=function(){this._isTickUsed||(this._schedule(this.consumeFunctionBuffer),this._isTickUsed=!0)},d.prototype._reset=function(){this._isTickUsed=!1,this._length=0},b.exports=new d}).call(this,a("FWaASH"))},{"./queue.js":25,"./schedule.js":28,"./util.js":35,FWaASH:36}],3:[function(a,b){"use strict";var c=a("./promise.js")();b.exports=c},{"./promise.js":20}],4:[function(a,b){"use strict";var c=Object.create,d=c&&c(null),e=c&&c(null);d[" size"]=e[" size"]=0,b.exports=function(b){function c(a){return new Function("obj","                                             \n        'use strict'                                                         \n        var len = this.length;                                               \n        switch(len) {                                                        \n            case 1: return obj.methodName(this[0]);                          \n            case 2: return obj.methodName(this[0], this[1]);                 \n            case 3: return obj.methodName(this[0], this[1], this[2]);        \n            case 0: return obj.methodName();                                 \n            default: return obj.methodName.apply(obj, this);                 \n        }                                                                    \n        ".replace(/methodName/g,a))}function f(a){return new Function("obj","                                             \n        'use strict';                                                        \n        return obj.propertyName;                                             \n        ".replace("propertyName",a))}function g(a,b,c){var d=c[a];if("function"!=typeof d){if(!o(a))return null;if(d=b(a),c[a]=d,c[" size"]++,c[" size"]>512){for(var e=Object.keys(c),f=0;256>f;++f)delete c[e[f]];c[" size"]=e.length-256}}return d}function h(a){return g(a,c,d)}function i(a){return g(a,f,e)}function j(a){return a[this.pop()].apply(a,this)}function k(a){return a[this]}function l(a){return a[this]}var m=a("./util.js"),n=m.canEvaluate,o=m.isIdentifier;b.prototype.call=function(a){for(var b=arguments.length,c=new Array(b-1),d=1;b>d;++d)c[d-1]=arguments[d];if(n){var e=h(a);if(null!==e)return this._then(e,void 0,void 0,c,void 0)}return c.push(a),this._then(j,void 0,void 0,c,void 0)},b.prototype.get=function(a){var b,c="number"==typeof a;if(c)b=l;else if(n){var d=i(a);b=null!==d?d:k}else b=k;return this._then(b,void 0,void 0,a,void 0)}}},{"./util.js":35}],5:[function(a,b){"use strict";b.exports=function(b,c){var d=a("./errors.js"),e=d.canAttach,f=a("./async.js"),g=d.CancellationError;b.prototype._cancel=function(a){if(!this.isCancellable())return this;for(var b,c=this;void 0!==(b=c._cancellationParent)&&b.isCancellable();)c=b;c._attachExtraTrace(a),c._rejectUnchecked(a)},b.prototype.cancel=function(a){return this.isCancellable()?(a=void 0!==a?e(a)?a:new Error(a+""):new g,f.invokeLater(this._cancel,this,a),this):this},b.prototype.cancellable=function(){return this._cancellable()?this:(this._setCancellable(),this._cancellationParent=void 0,this)},b.prototype.uncancellable=function(){var a=new b(c);return a._propagateFrom(this,6),a._follow(this),a._unsetCancellable(),a},b.prototype.fork=function(a,b,c){var d=this._then(a,b,c,void 0,void 0);return d._setCancellable(),d._cancellationParent=void 0,d}}},{"./async.js":2,"./errors.js":10}],6:[function(a,b){"use strict";b.exports=function(){function b(a){var b;if("function"==typeof a)b="[function "+(a.name||"anonymous")+"]";else{b=a.toString();var d=/\[object [a-zA-Z0-9$_]+\]/;if(d.test(b))try{var e=JSON.stringify(a);b=e}catch(f){}0===b.length&&(b="(empty array)")}return"(<"+c(b)+">, no stack trace)"}function c(a){var b=41;return a.length<b?a:a.substr(0,b-3)+"..."}function d(a,b){this.captureStackTrace(d,b)}var e=a("./util.js").inherits,f=a("./es5.js").defineProperty,g=new RegExp("\\b(?:[a-zA-Z0-9.]+\\$_\\w+|tryCatch(?:1|2|3|4|Apply)|new \\w*PromiseArray|\\w*PromiseArray\\.\\w*PromiseArray|setTimeout|CatchFilter\\$_\\w+|makeNodePromisified|processImmediate|process._tickCallback|nextTick|Async\\$\\w+)\\b"),h=null,i=null;e(d,Error),d.prototype.captureStackTrace=function(a,b){j(this,a,b)},d.possiblyUnhandledRejection=function(a){if("object"==typeof console){var b;if("object"==typeof a||"function"==typeof a){var c=a.stack;b="Possibly unhandled "+i(c,a)}else b="Possibly unhandled "+String(a);"function"==typeof console.error||"object"==typeof console.error?console.error(b):("function"==typeof console.log||"object"==typeof console.log)&&console.log(b)}},d.combine=function(a,b){for(var c=a.length-1,d=b.length-1;d>=0;--d){var e=b[d];if(a[c]!==e)break;a.pop(),c--}a.push("From previous event:");for(var f=a.concat(b),i=[],d=0,j=f.length;j>d;++d)g.test(f[d])||d>0&&!h.test(f[d])&&"From previous event:"!==f[d]||i.push(f[d]);return i},d.isSupported=function(){return"function"==typeof j};var j=function k(){if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){h=/^\s*at\s*/,i=function(a,c){return"string"==typeof a?a:void 0!==c.name&&void 0!==c.message?c.name+". "+c.message:b(c)};var a=Error.captureStackTrace;return function(b,c){a(b,c)}}var c=new Error;if("string"==typeof c.stack&&"function"==typeof"".startsWith&&c.stack.startsWith("stackDetection@")&&"stackDetection"===k.name){f(Error,"stackTraceLimit",{writable:!0,enumerable:!1,configurable:!1,value:25}),h=/@/;var d=/[@\n]/;return i=function(a,c){return"string"==typeof a?c.name+". "+c.message+"\n"+a:void 0!==c.name&&void 0!==c.message?c.name+". "+c.message:b(c)},function(a){for(var b=(new Error).stack,c=b.split(d),e=c.length,f="",g=0;e>g;g+=2)f+=c[g],f+="@",f+=c[g+1],f+="\n";a.stack=f}}return i=function(a,c){return"string"==typeof a?a:"object"!=typeof c&&"function"!=typeof c||void 0===c.name||void 0===c.message?b(c):c.name+". "+c.message},null}();return d}},{"./es5.js":12,"./util.js":35}],7:[function(a,b){"use strict";b.exports=function(b){function c(a,b,c){this._instances=a,this._callback=b,this._promise=c}function d(a,b){var c={},d=g(a,c,b);if(d===h)return d;var e=i(c);return e.length?(h.e=new j("Catch filter must inherit from Error or be a simple predicate function"),h):d}var e=a("./util.js"),f=a("./errors.js"),g=e.tryCatch1,h=e.errorObj,i=a("./es5.js").keys,j=f.TypeError;return c.prototype.doFilter=function(a){for(var c=this._callback,e=this._promise,i=e._boundTo,j=0,k=this._instances.length;k>j;++j){var l=this._instances[j],m=l===Error||null!=l&&l.prototype instanceof Error;if(m&&a instanceof l){var n=g(c,i,a);return n===h?(b.e=n.e,b):n}if("function"==typeof l&&!m){var o=d(l,a);if(o===h){var p=f.canAttach(h.e)?h.e:new Error(h.e+"");this._promise._attachExtraTrace(p),a=h.e;break}if(o){var n=g(c,i,a);return n===h?(b.e=n.e,b):n}}}return b.e=a,b},c}},{"./errors.js":10,"./es5.js":12,"./util.js":35}],8:[function(a,b){"use strict";var c=a("./util.js"),d=c.isPrimitive,e=c.wrapsPrimitiveReceiver;b.exports=function(a){var b=function(){return this},c=function(){throw this},f=function(a,b){return 1===b?function(){throw a}:2===b?function(){return a}:void 0};a.prototype["return"]=a.prototype.thenReturn=function(a){return e&&d(a)?this._then(f(a,2),void 0,void 0,void 0,void 0):this._then(b,void 0,void 0,a,void 0)},a.prototype["throw"]=a.prototype.thenThrow=function(a){return e&&d(a)?this._then(f(a,1),void 0,void 0,void 0,void 0):this._then(c,void 0,void 0,a,void 0)}}},{"./util.js":35}],9:[function(a,b){"use strict";b.exports=function(a,b){var c=a.reduce;a.prototype.each=function(a){return c(this,a,null,b)},a.each=function(a,d){return c(a,d,null,b)}}},{}],10:[function(a,b){"use strict";function c(a){try{n(a,"isOperational",!0)}catch(b){}}function d(a){return null==a?!1:a instanceof h||a.isOperational===!0}function e(a){return a instanceof Error}function f(a){return e(a)}function g(a,b){function c(d){return this instanceof c?(this.message="string"==typeof d?d:b,this.name=a,void(Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new c(d)}return m(c,Error),c}function h(a){this.name="OperationalError",this.message=a,this.cause=a,this.isOperational=!0,a instanceof Error?(this.message=a.message,this.stack=a.stack):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}var i,j,k=a("./es5.js").freeze,l=a("./util.js"),m=l.inherits,n=l.notEnumerableProp,o=g("CancellationError","cancellation error"),p=g("TimeoutError","timeout error"),q=g("AggregateError","aggregate error");try{i=TypeError,j=RangeError}catch(r){i=g("TypeError","type error"),j=g("RangeError","range error")}for(var s="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),t=0;t<s.length;++t)"function"==typeof Array.prototype[s[t]]&&(q.prototype[s[t]]=Array.prototype[s[t]]);q.prototype.length=0,q.prototype.isOperational=!0;var u=0;q.prototype.toString=function(){var a=Array(4*u+1).join(" "),b="\n"+a+"AggregateError of:\n";u++,a=Array(4*u+1).join(" ");for(var c=0;c<this.length;++c){for(var d=this[c]===this?"[Circular AggregateError]":this[c]+"",e=d.split("\n"),f=0;f<e.length;++f)e[f]=a+e[f];d=e.join("\n"),b+=d+"\n"}return u--,b},m(h,Error);var v="__BluebirdErrorTypes__",w=Error[v];w||(w=k({CancellationError:o,TimeoutError:p,OperationalError:h,RejectionError:h,AggregateError:q}),n(Error,v,w)),b.exports={Error:Error,TypeError:i,RangeError:j,CancellationError:w.CancellationError,OperationalError:w.OperationalError,TimeoutError:w.TimeoutError,AggregateError:w.AggregateError,originatesFromRejection:d,markAsOriginatingFromRejection:c,canAttach:f}},{"./es5.js":12,"./util.js":35}],11:[function(a,b){"use strict";b.exports=function(b){function c(a){var c=new d(a),e=b.rejected(c),f=e._peekContext();return null!=f&&f._attachExtraTrace(c),e}var d=a("./errors.js").TypeError;return c}},{"./errors.js":10}],12:[function(a,b){var c=function(){"use strict";return void 0===this}();if(c)b.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,keys:Object.keys,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:c};else{var d={}.hasOwnProperty,e={}.toString,f={}.constructor.prototype,g=function(a){var b=[];for(var c in a)d.call(a,c)&&b.push(c);return b},h=function(a,b,c){return a[b]=c.value,a},i=function(a){return a},j=function(a){try{return Object(a).constructor.prototype}catch(b){return f}},k=function(a){try{return"[object Array]"===e.call(a)}catch(b){return!1}};b.exports={isArray:k,keys:g,defineProperty:h,freeze:i,getPrototypeOf:j,isES5:c}}},{}],13:[function(a,b){"use strict";b.exports=function(a,b){var c=a.map;a.prototype.filter=function(a,d){return c(this,a,d,b)},a.filter=function(a,d,e){return c(a,d,e,b)}}},{}],14:[function(a,b){"use strict";b.exports=function(b,c,d){function e(){return this}function f(){throw this}function g(a){return function(){return a}}function h(a){return function(){throw a}}function i(a,b,c){var d;return d=m&&n(b)?c?g(b):h(b):c?e:f,a._then(d,o,void 0,b,void 0)}function j(a){var e=this.promise,f=this.handler,g=e._isBound()?f.call(e._boundTo):f();if(void 0!==g){var h=d(g,void 0);if(h instanceof b)return i(h,a,e.isFulfilled())}return e.isRejected()?(c.e=a,c):a}function k(a){var c=this.promise,e=this.handler,f=c._isBound()?e.call(c._boundTo,a):e(a);if(void 0!==f){var g=d(f,void 0);if(g instanceof b)return i(g,a,!0)}return a}var l=a("./util.js"),m=l.wrapsPrimitiveReceiver,n=l.isPrimitive,o=l.thrower;b.prototype._passThroughHandler=function(a,b){if("function"!=typeof a)return this.then();var c={promise:this,handler:a};return this._then(b?j:k,b?j:void 0,void 0,c,void 0)},b.prototype.lastly=b.prototype["finally"]=function(a){return this._passThroughHandler(a,!0)},b.prototype.tap=function(a){return this._passThroughHandler(a,!1)}}},{"./util.js":35}],15:[function(a,b){"use strict";b.exports=function(b,c,d,e){function f(a){for(var c=n,d=l,g=b,h=c.length,i=0;h>i;++i){var j=m(c[i],void 0,a);if(j===d)return g.reject(d.e);var k=e(j,f);if(k instanceof g)return k}return null}function g(a,c){var e=this._promise=new b(d);e._setTrace(void 0),this._generatorFunction=a,this._receiver=c,this._generator=void 0}var h=a("./errors.js"),i=h.TypeError,j=a("./util.js").deprecated,k=a("./util.js"),l=k.errorObj,m=k.tryCatch1,n=[];g.prototype.promise=function(){return this._promise},g.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._next(void 0)},g.prototype._continue=function(a){if(a===l){this._generator=void 0;var c=h.canAttach(a.e)?a.e:new Error(a.e+"");return this._promise._attachExtraTrace(c),void this._promise._reject(a.e,c)}var d=a.value;if(a.done===!0)this._generator=void 0,this._promise._tryFollow(d)||this._promise._fulfill(d);else{var g=e(d,void 0);if(!(g instanceof b)&&(g=f(g),null===g))return void this._throw(new i("A value was yielded that could not be treated as a promise"));g._then(this._next,this._throw,void 0,this,null)}},g.prototype._throw=function(a){h.canAttach(a)&&this._promise._attachExtraTrace(a),this._continue(m(this._generator["throw"],this._generator,a))},g.prototype._next=function(a){this._continue(m(this._generator.next,this._generator,a))},b.coroutine=function(a){if("function"!=typeof a)throw new i("generatorFunction must be a function");var b=g;return function(){var c=a.apply(this,arguments),d=new b(void 0,void 0);return d._generator=c,d._next(void 0),d.promise()}},b.coroutine.addYieldHandler=function(a){if("function"!=typeof a)throw new i("fn must be a function");n.push(a)},b.spawn=function(a){if(j("Promise.spawn is deprecated. Use Promise.coroutine instead."),"function"!=typeof a)return c("generatorFunction must be a function");var d=new g(a,this),e=d.promise();return d._run(b.spawn),e}}},{"./errors.js":10,"./util.js":35}],16:[function(a,b){"use strict";b.exports=function(b,c,d,e){var f=a("./util.js"),g=f.canEvaluate,h=f.tryCatch1,i=f.errorObj;if(g){for(var j=function(a){return new Function("value","holder","                             \n            'use strict';                                                    \n            holder.pIndex = value;                                           \n            holder.checkFulfillment(this);                                   \n            ".replace(/Index/g,a))},k=function(a){for(var b=[],c=1;a>=c;++c)b.push("holder.p"+c);return new Function("holder","                                      \n            'use strict';                                                    \n            var callback = holder.fn;                                        \n            return callback(values);                                         \n            ".replace(/values/g,b.join(", ")))},l=[],m=[void 0],n=1;5>=n;++n)l.push(j(n)),m.push(k(n));var o=function(a,b){this.p1=this.p2=this.p3=this.p4=this.p5=null,this.fn=b,this.total=a,this.now=0};o.prototype.callers=m,o.prototype.checkFulfillment=function(a){var b=this.now;b++;var c=this.total;if(b>=c){var d=this.callers[c],e=h(d,void 0,this);e===i?a._rejectUnchecked(e.e):a._tryFollow(e)||a._fulfillUnchecked(e)}else this.now=b}}b.join=function(){var a,f=arguments.length-1;if(f>0&&"function"==typeof arguments[f]&&(a=arguments[f],6>f&&g)){var h=new b(e);h._setTrace(void 0);for(var i=new o(f,a),j=h._reject,k=l,m=0;f>m;++m){var n=d(arguments[m],void 0);n instanceof b?n.isPending()?n._then(k[m],j,void 0,h,i):n.isFulfilled()?k[m].call(h,n._settledValue,i):(h._reject(n._settledValue),n._unsetRejectionIsUnhandled()):k[m].call(h,n,i)}return h}for(var p=arguments.length,q=new Array(p),r=0;p>r;++r)q[r]=arguments[r];var h=new c(q).promise();return void 0!==a?h.spread(a):h}}},{"./util.js":35}],17:[function(a,b){"use strict";b.exports=function(b,c,d,e,f){function g(a,b,c,d){this.constructor$(a),this._callback=b,this._preservedValues=d===f?new Array(this.length()):null,this._limit=c,this._inFlight=0,this._queue=c>=1?[]:m,this._init$(void 0,-2)}function h(a,b,c,d){var e="object"==typeof c&&null!==c?c.concurrency:0;return e="number"==typeof e&&isFinite(e)&&e>=1?e:0,new g(a,b,e,d)}var i=a("./util.js"),j=i.tryCatch3,k=i.errorObj,l={},m=[];i.inherits(g,c),g.prototype._init=function(){},g.prototype._promiseFulfilled=function(a,c){var d=this._values;if(null!==d){var f=this.length(),g=this._preservedValues,h=this._limit;if(d[c]===l){if(d[c]=a,h>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return}else{if(h>=1&&this._inFlight>=h)return d[c]=a,void this._queue.push(c);null!==g&&(g[c]=a);var i=this._callback,m=this._promise._boundTo,n=j(i,m,a,c,f);if(n===k)return this._reject(n.e);var o=e(n,void 0);if(o instanceof b){if(o.isPending())return h>=1&&this._inFlight++,d[c]=l,o._proxyPromiseArray(this,c);if(!o.isFulfilled())return o._unsetRejectionIsUnhandled(),this._reject(o.reason());n=o.value()}d[c]=n}var p=++this._totalResolved;p>=f&&(null!==g?this._filter(d,g):this._resolve(d))}},g.prototype._drainQueue=function(){for(var a=this._queue,b=this._limit,c=this._values;a.length>0&&this._inFlight<b;){var d=a.pop();this._promiseFulfilled(c[d],d)}},g.prototype._filter=function(a,b){for(var c=b.length,d=new Array(c),e=0,f=0;c>f;++f)a[f]&&(d[e++]=b[f]);d.length=e,this._resolve(d)},g.prototype.preservedValues=function(){return this._preservedValues},b.prototype.map=function(a,b){return"function"!=typeof a?d("fn must be a function"):h(this,a,b,null).promise()},b.map=function(a,b,c,e){return"function"!=typeof b?d("fn must be a function"):h(a,b,c,e).promise()}}},{"./util.js":35}],18:[function(a,b){"use strict";b.exports=function(b){function c(a){throw a}function d(a,b){if(!g.isArray(a))return e(a,b);var d=g.tryCatchApply(this,[null].concat(a),b);d===k&&h.invokeLater(c,void 0,d.e)}function e(a,b){var d=this,e=void 0===a?j(d,b,null):i(d,b,null,a);e===k&&h.invokeLater(c,void 0,e.e)}function f(a,b){var d=this,e=j(d,b,a);e===k&&h.invokeLater(c,void 0,e.e)}var g=a("./util.js"),h=a("./async.js"),i=g.tryCatch2,j=g.tryCatch1,k=g.errorObj;b.prototype.nodeify=function(a,b){if("function"==typeof a){var c=e;void 0!==b&&Object(b).spread&&(c=d),this._then(c,f,void 0,a,this._boundTo)}return this}}},{"./async.js":2,"./util.js":35}],19:[function(a,b){"use strict";b.exports=function(b,c){var d=a("./util.js"),e=a("./async.js"),f=a("./errors.js"),g=d.tryCatch1,h=d.errorObj;b.prototype.progressed=function(a){return this._then(void 0,void 0,a,void 0,void 0)},b.prototype._progress=function(a){this._isFollowingOrFulfilledOrRejected()||this._progressUnchecked(a)},b.prototype._progressHandlerAt=function(a){return 0===a?this._progressHandler0:this[(a<<2)+a-5+2]},b.prototype._doProgressWith=function(a){var c=a.value,d=a.handler,e=a.promise,i=a.receiver,j=g(d,i,c);if(j===h){if(null!=j.e&&"StopProgressPropagation"!==j.e.name){var k=f.canAttach(j.e)?j.e:new Error(j.e+"");e._attachExtraTrace(k),e._progress(j.e)}}else j instanceof b?j._then(e._progress,null,null,e,void 0):e._progress(j)},b.prototype._progressUnchecked=function(a){if(this.isPending())for(var d=this._length(),f=this._progress,g=0;d>g;g++){var h=this._progressHandlerAt(g),i=this._promiseAt(g);if(i instanceof b)"function"==typeof h?e.invoke(this._doProgressWith,this,{handler:h,promise:i,receiver:this._receiverAt(g),value:a}):e.invoke(f,i,a);else{var j=this._receiverAt(g);"function"==typeof h?h.call(j,a,i):j instanceof b&&j._isProxied()?j._progressUnchecked(a):j instanceof c&&j._promiseProgressed(a,i)}}}}},{"./async.js":2,"./errors.js":10,"./util.js":35}],20:[function(a,b){(function(c){"use strict";function d(a){try{Promise===a&&(Promise=e)}catch(b){}return a}var e;"undefined"!=typeof Promise&&(e=Promise),b.exports=function(){function b(a){if("function"!=typeof a)throw new v("the promise constructor requires a resolver function");if(this.constructor!==b)throw new v("the promise constructor cannot be invoked directly");this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._settledValue=void 0,this._boundTo=void 0,a!==h&&this._resolveFromResolver(a)}var e=a("./util.js"),f=a("./async.js"),g=a("./errors.js"),h=function(){},i={},j={e:null},k=a("./thenables.js")(b,h),l=a("./promise_array.js")(b,h,k),m=a("./captured_trace.js")(),n=a("./catch_filter.js")(j),o=a("./promise_resolver.js"),p=e.isArray,q=e.errorObj,r=e.tryCatch1,s=e.tryCatch2,t=e.tryCatchApply,u=g.RangeError,v=g.TypeError,w=g.CancellationError,x=g.TimeoutError,y=g.OperationalError,z=g.originatesFromRejection,A=g.markAsOriginatingFromRejection,B=g.canAttach,C=e.thrower,D=a("./errors_api_rejection")(b),E=function(){return new v("circular promise resolution chain")};b.prototype.bind=function(a){var c=new b(h);return c._follow(this),c._propagateFrom(this,3),c._setBoundTo(a),c},b.prototype.toString=function(){return"[object Promise]"},b.prototype.caught=b.prototype["catch"]=function(a){var b=arguments.length;if(b>1){var c,d=new Array(b-1),e=0;for(c=0;b-1>c;++c){var g=arguments[c];if("function"!=typeof g){var h=new v("A catch filter must be an error constructor or a filter function");return this._attachExtraTrace(h),void f.invoke(this._reject,this,h)}d[e++]=g}d.length=e,a=arguments[c],this._resetTrace();var i=new n(d,a,this);return this._then(void 0,i.doFilter,void 0,i,void 0)}return this._then(void 0,a,void 0,void 0,void 0)},b.prototype.then=function(a,b,c){return this._then(a,b,c,void 0,void 0)},b.prototype.done=function(a,b,c){var d=this._then(a,b,c,void 0,void 0);d._setIsFinal()},b.prototype.spread=function(a,b){return this._then(a,b,void 0,i,void 0)},b.prototype.isCancellable=function(){return!this.isResolved()&&this._cancellable()},b.prototype.toJSON=function(){var a={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(a.fulfillmentValue=this._settledValue,a.isFulfilled=!0):this.isRejected()&&(a.rejectionReason=this._settledValue,a.isRejected=!0),a},b.prototype.all=function(){return new l(this).promise()},b.is=function(a){return a instanceof b},b.all=function(a){return new l(a).promise()},b.prototype.error=function(a){return this.caught(z,a)},b.prototype._resolveFromSyncValue=function(a){if(a===q)this._cleanValues(),this._setRejected(),this._settledValue=a.e,this._ensurePossibleRejectionHandled();else{var c=k(a,void 0);c instanceof b?this._follow(c):(this._cleanValues(),this._setFulfilled(),this._settledValue=a)}},b.method=function(a){if("function"!=typeof a)throw new v("fn must be a function");return function(){var c;switch(arguments.length){case 0:c=r(a,this,void 0);break;case 1:c=r(a,this,arguments[0]);break;case 2:c=s(a,this,arguments[0],arguments[1]);break;default:for(var d=arguments.length,e=new Array(d),f=0;d>f;++f)e[f]=arguments[f];c=t(a,e,this)}var g=new b(h);return g._setTrace(void 0),g._resolveFromSyncValue(c),g}},b.attempt=b["try"]=function(a,c,d){if("function"!=typeof a)return D("fn must be a function");var e=p(c)?t(a,c,d):r(a,d,c),f=new b(h);return f._setTrace(void 0),f._resolveFromSyncValue(e),f},b.defer=b.pending=function(){var a=new b(h);return a._setTrace(void 0),new o(a)},b.bind=function(a){var c=new b(h);return c._setTrace(void 0),c._setFulfilled(),c._setBoundTo(a),c},b.cast=function(a){var c=k(a,void 0);if(!(c instanceof b)){var d=c;c=new b(h),c._setTrace(void 0),c._setFulfilled(),c._cleanValues(),c._settledValue=d}return c},b.resolve=b.fulfilled=b.cast,b.reject=b.rejected=function(a){var c=new b(h);if(c._setTrace(void 0),A(a),c._cleanValues(),c._setRejected(),c._settledValue=a,!B(a)){var d=new Error(a+"");c._setCarriedStackTrace(d)}return c._ensurePossibleRejectionHandled(),c},b.onPossiblyUnhandledRejection=function(a){m.possiblyUnhandledRejection="function"==typeof a?a:void 0};var F;b.onUnhandledRejectionHandled=function(a){F="function"==typeof a?a:void 0};var G=!1||!("undefined"==typeof c||"string"!=typeof c.execPath||"object"!=typeof c.env||!c.env.BLUEBIRD_DEBUG&&"development"!==c.env.NODE_ENV);b.longStackTraces=function(){if(f.haveItemsQueued()&&G===!1)throw new Error("cannot enable long stack traces after promises have been created");G=m.isSupported()},b.hasLongStackTraces=function(){return G&&m.isSupported()},b.prototype._then=function(a,c,d,e,g){var i=void 0!==g,j=i?g:new b(h);if(!i){if(G){var k=this._peekContext()===this._traceParent;j._traceParent=k?this._traceParent:this}j._propagateFrom(this,7)}var l=this._addCallbacks(a,c,d,j,e);return this.isResolved()&&f.invoke(this._queueSettleAt,this,l),j},b.prototype._length=function(){return 262143&this._bitField},b.prototype._isFollowingOrFulfilledOrRejected=function(){return(939524096&this._bitField)>0},b.prototype._isFollowing=function(){return 536870912===(536870912&this._bitField)},b.prototype._setLength=function(a){this._bitField=-262144&this._bitField|262143&a},b.prototype._setFulfilled=function(){this._bitField=268435456|this._bitField},b.prototype._setRejected=function(){this._bitField=134217728|this._bitField},b.prototype._setFollowing=function(){this._bitField=536870912|this._bitField},b.prototype._setIsFinal=function(){this._bitField=33554432|this._bitField},b.prototype._isFinal=function(){return(33554432&this._bitField)>0},b.prototype._cancellable=function(){return(67108864&this._bitField)>0},b.prototype._setCancellable=function(){this._bitField=67108864|this._bitField},b.prototype._unsetCancellable=function(){this._bitField=-67108865&this._bitField},b.prototype._setRejectionIsUnhandled=function(){this._bitField=2097152|this._bitField},b.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-2097153&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},b.prototype._isRejectionUnhandled=function(){return(2097152&this._bitField)>0},b.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=524288|this._bitField},b.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-524289&this._bitField},b.prototype._isUnhandledRejectionNotified=function(){return(524288&this._bitField)>0},b.prototype._setCarriedStackTrace=function(a){this._bitField=1048576|this._bitField,this._fulfillmentHandler0=a},b.prototype._unsetCarriedStackTrace=function(){this._bitField=-1048577&this._bitField,this._fulfillmentHandler0=void 0},b.prototype._isCarryingStackTrace=function(){return(1048576&this._bitField)>0},b.prototype._getCarriedStackTrace=function(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:void 0},b.prototype._receiverAt=function(a){var b=0===a?this._receiver0:this[(a<<2)+a-5+4];return this._isBound()&&void 0===b?this._boundTo:b},b.prototype._promiseAt=function(a){return 0===a?this._promise0:this[(a<<2)+a-5+3]},b.prototype._fulfillmentHandlerAt=function(a){return 0===a?this._fulfillmentHandler0:this[(a<<2)+a-5+0]},b.prototype._rejectionHandlerAt=function(a){return 0===a?this._rejectionHandler0:this[(a<<2)+a-5+1]},b.prototype._addCallbacks=function(a,b,c,d,e){var f=this._length();if(f>=262138&&(f=0,this._setLength(0)),0===f)this._promise0=d,void 0!==e&&(this._receiver0=e),"function"!=typeof a||this._isCarryingStackTrace()||(this._fulfillmentHandler0=a),"function"==typeof b&&(this._rejectionHandler0=b),"function"==typeof c&&(this._progressHandler0=c);else{var g=(f<<2)+f-5;this[g+3]=d,this[g+4]=e,this[g+0]="function"==typeof a?a:void 0,this[g+1]="function"==typeof b?b:void 0,this[g+2]="function"==typeof c?c:void 0}return this._setLength(f+1),f},b.prototype._setProxyHandlers=function(a,b){var c=this._length();if(c>=262138&&(c=0,this._setLength(0)),0===c)this._promise0=b,this._receiver0=a;else{var d=(c<<2)+c-5;this[d+3]=b,this[d+4]=a,this[d+0]=this[d+1]=this[d+2]=void 0}this._setLength(c+1)},b.prototype._proxyPromiseArray=function(a,b){this._setProxyHandlers(a,b)},b.prototype._proxyPromise=function(a){a._setProxied(),this._setProxyHandlers(a,-1)},b.prototype._setBoundTo=function(a){void 0!==a?(this._bitField=8388608|this._bitField,this._boundTo=a):this._bitField=-8388609&this._bitField},b.prototype._isBound=function(){return 8388608===(8388608&this._bitField)},b.prototype._resolveFromResolver=function(a){function b(a){d._tryFollow(a)||d._fulfill(a)}function c(a){var b=B(a)?a:new Error(a+"");d._attachExtraTrace(b),A(a),d._reject(a,b===a?void 0:b)}var d=this;this._setTrace(void 0),this._pushContext();var e=s(a,void 0,b,c);if(this._popContext(),void 0!==e&&e===q){var f=e.e,g=B(f)?f:new Error(f+"");d._reject(f,g)}},b.prototype._spreadSlowCase=function(a,b,c,d){var e=new l(c).promise();e._then(function(){return a.apply(d,arguments)},h,void 0,i,void 0),b._follow(e)},b.prototype._callSpread=function(a,c,d){var e=this._boundTo;if(p(d))for(var f=0,g=d.length;g>f;++f)if(k(d[f],void 0)instanceof b)return void this._spreadSlowCase(a,c,d,e);return c._pushContext(),t(a,d,e)},b.prototype._callHandler=function(a,b,c,d){var e;return b!==i||this.isRejected()?(c._pushContext(),e=r(a,b,d)):e=this._callSpread(a,c,d),c._popContext(),e},b.prototype._settlePromiseFromHandler=function(a,c,d,e){if(!(e instanceof b))return void a.call(c,d,e);var f=this._callHandler(a,c,e,d);if(!e._isFollowing())if(f===q||f===e||f===j){var g=f===e?E():f.e,h=B(g)?g:new Error(g+"");f!==j&&e._attachExtraTrace(h),e._rejectUnchecked(g,h)}else{var i=k(f,e);if(i instanceof b){if(i.isRejected()&&!i._isCarryingStackTrace()&&!B(i._settledValue)){var h=new Error(i._settledValue+"");e._attachExtraTrace(h),i._setCarriedStackTrace(h)}e._follow(i),e._propagateFrom(i,1)}else e._fulfillUnchecked(f)}},b.prototype._follow=function(a){this._setFollowing(),a.isPending()?(this._propagateFrom(a,1),a._proxyPromise(this)):a.isFulfilled()?this._fulfillUnchecked(a._settledValue):this._rejectUnchecked(a._settledValue,a._getCarriedStackTrace()),a._isRejectionUnhandled()&&a._unsetRejectionIsUnhandled(),G&&null==a._traceParent&&(a._traceParent=this)},b.prototype._tryFollow=function(a){if(this._isFollowingOrFulfilledOrRejected()||a===this)return!1;var c=k(a,void 0);return c instanceof b?(this._follow(c),!0):!1},b.prototype._resetTrace=function(){G&&(this._trace=new m(void 0===this._peekContext()))
},b.prototype._setTrace=function(a){if(G){var b=this._peekContext();this._traceParent=b;var c=void 0===b;this._trace=void 0!==a&&a._traceParent===b?a._trace:new m(c)}return this},b.prototype._attachExtraTrace=function(a){if(G){var b=this,c=a.stack;c="string"==typeof c?c.split("\n"):[];for(var d=1,e=1;null!=b&&null!=b._trace;)c=m.combine(c,b._trace.stack.split("\n")),b=b._traceParent,e++;var f=Error.stackTraceLimit||10,g=(f+d)*e,h=c.length;h>g&&(c.length=g),a.stack=c.length<=d?"(No stack trace)":c.join("\n")}},b.prototype._cleanValues=function(){this._cancellable()&&(this._cancellationParent=void 0)},b.prototype._propagateFrom=function(a,b){(1&b)>0&&a._cancellable()&&(this._setCancellable(),this._cancellationParent=a),(4&b)>0&&this._setBoundTo(a._boundTo),(2&b)>0&&this._setTrace(a)},b.prototype._fulfill=function(a){this._isFollowingOrFulfilledOrRejected()||this._fulfillUnchecked(a)},b.prototype._reject=function(a,b){this._isFollowingOrFulfilledOrRejected()||this._rejectUnchecked(a,b)},b.prototype._settlePromiseAt=function(a){var c=this.isFulfilled()?this._fulfillmentHandlerAt(a):this._rejectionHandlerAt(a),d=this._settledValue,e=this._receiverAt(a),f=this._promiseAt(a);if("function"==typeof c)this._settlePromiseFromHandler(c,e,d,f);else{var g=!1,h=this.isFulfilled();void 0!==e&&(e instanceof b&&e._isProxied()?(e._unsetProxied(),h?e._fulfillUnchecked(d):e._rejectUnchecked(d,this._getCarriedStackTrace()),g=!0):e instanceof l&&(h?e._promiseFulfilled(d,f):e._promiseRejected(d,f),g=!0)),g||(h?f._fulfill(d):f._reject(d,this._getCarriedStackTrace()))}a>=256&&this._queueGC()},b.prototype._isProxied=function(){return 4194304===(4194304&this._bitField)},b.prototype._setProxied=function(){this._bitField=4194304|this._bitField},b.prototype._unsetProxied=function(){this._bitField=-4194305&this._bitField},b.prototype._isGcQueued=function(){return-1073741824===(-1073741824&this._bitField)},b.prototype._setGcQueued=function(){this._bitField=-1073741824|this._bitField},b.prototype._unsetGcQueued=function(){this._bitField=1073741823&this._bitField},b.prototype._queueGC=function(){this._isGcQueued()||(this._setGcQueued(),f.invokeLater(this._gc,this,void 0))},b.prototype._gc=function(){for(var a=5*this._length(),b=0;a>b;b++)delete this[b];this._setLength(0),this._unsetGcQueued()},b.prototype._queueSettleAt=function(a){this._isRejectionUnhandled()&&this._unsetRejectionIsUnhandled(),f.invoke(this._settlePromiseAt,this,a)},b.prototype._fulfillUnchecked=function(a){if(this.isPending()){if(a===this){var b=E();return this._attachExtraTrace(b),this._rejectUnchecked(b,void 0)}this._cleanValues(),this._setFulfilled(),this._settledValue=a;var c=this._length();c>0&&f.invoke(this._settlePromises,this,c)}},b.prototype._rejectUncheckedCheckError=function(a){var b=B(a)?a:new Error(a+"");this._rejectUnchecked(a,b===a?void 0:b)},b.prototype._rejectUnchecked=function(a,b){if(this.isPending()){if(a===this){var c=E();return this._attachExtraTrace(c),this._rejectUnchecked(c)}if(this._cleanValues(),this._setRejected(),this._settledValue=a,this._isFinal())return void f.invokeLater(C,void 0,void 0===b?a:b);var d=this._length();void 0!==b&&this._setCarriedStackTrace(b),d>0?f.invoke(this._rejectPromises,this,null):this._ensurePossibleRejectionHandled()}},b.prototype._rejectPromises=function(){this._settlePromises(),this._unsetCarriedStackTrace()},b.prototype._settlePromises=function(){for(var a=this._length(),b=0;a>b;b++)this._settlePromiseAt(b)},b.prototype._ensurePossibleRejectionHandled=function(){this._setRejectionIsUnhandled(),void 0!==m.possiblyUnhandledRejection&&f.invokeLater(this._notifyUnhandledRejection,this,void 0)},b.prototype._notifyUnhandledRejectionIsHandled=function(){"function"==typeof F&&f.invokeLater(F,void 0,this)},b.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var a=this._settledValue,b=this._getCarriedStackTrace();this._setUnhandledRejectionIsNotified(),void 0!==b&&(this._unsetCarriedStackTrace(),a=b),"function"==typeof m.possiblyUnhandledRejection&&m.possiblyUnhandledRejection(a,this)}};var H=[];return b.prototype._peekContext=function(){var a=H.length-1;return a>=0?H[a]:void 0},b.prototype._pushContext=function(){G&&H.push(this)},b.prototype._popContext=function(){G&&H.pop()},b.noConflict=function(){return d(b)},b.setScheduler=function(a){if("function"!=typeof a)throw new v("fn must be a function");f._schedule=a},m.isSupported()||(b.longStackTraces=function(){},G=!1),b._makeSelfResolutionError=E,a("./finally.js")(b,j,k),a("./direct_resolve.js")(b),a("./synchronous_inspection.js")(b),a("./join.js")(b,l,k,h),b.RangeError=u,b.CancellationError=w,b.TimeoutError=x,b.TypeError=v,b.OperationalError=y,b.RejectionError=y,b.AggregateError=g.AggregateError,e.toFastProperties(b),e.toFastProperties(b.prototype),b.Promise=b,a("./timers.js")(b,h,k),a("./race.js")(b,h,k),a("./call_get.js")(b),a("./generators.js")(b,D,h,k),a("./map.js")(b,l,D,k,h),a("./nodeify.js")(b),a("./promisify.js")(b,h),a("./props.js")(b,l,k),a("./reduce.js")(b,l,D,k,h),a("./settle.js")(b,l),a("./some.js")(b,l,D),a("./progress.js")(b,l),a("./cancel.js")(b,h),a("./filter.js")(b,h),a("./any.js")(b,l),a("./each.js")(b,h),a("./using.js")(b,D,k),b.prototype=b.prototype,b}}).call(this,a("FWaASH"))},{"./any.js":1,"./async.js":2,"./call_get.js":4,"./cancel.js":5,"./captured_trace.js":6,"./catch_filter.js":7,"./direct_resolve.js":8,"./each.js":9,"./errors.js":10,"./errors_api_rejection":11,"./filter.js":13,"./finally.js":14,"./generators.js":15,"./join.js":16,"./map.js":17,"./nodeify.js":18,"./progress.js":19,"./promise_array.js":21,"./promise_resolver.js":22,"./promisify.js":23,"./props.js":24,"./race.js":26,"./reduce.js":27,"./settle.js":29,"./some.js":30,"./synchronous_inspection.js":31,"./thenables.js":32,"./timers.js":33,"./using.js":34,"./util.js":35,FWaASH:36}],21:[function(a,b){"use strict";b.exports=function(b,c,d){function e(a){switch(a){case-1:return void 0;case-2:return[];case-3:return{}}}function f(a){var d=this._promise=new b(c),e=void 0;a instanceof b&&(e=a,d._propagateFrom(e,5)),d._setTrace(e),this._values=a,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var g=a("./errors.js").canAttach,h=a("./util.js"),i=h.isArray;return f.prototype.length=function(){return this._length},f.prototype.promise=function(){return this._promise},f.prototype._init=function j(a,c){var f=d(this._values,void 0);if(f instanceof b){if(this._values=f,f._setBoundTo(this._promise._boundTo),!f.isFulfilled())return f.isPending()?void f._then(j,this._reject,void 0,this,c):(f._unsetRejectionIsUnhandled(),void this._reject(f._settledValue));if(f=f._settledValue,!i(f)){var g=new b.TypeError("expecting an array, a promise or a thenable");return void this.__hardReject__(g)}}else if(!i(f)){var g=new b.TypeError("expecting an array, a promise or a thenable");return void this.__hardReject__(g)}if(0===f.length)return void(-5===c?this._resolveEmptyArray():this._resolve(e(c)));for(var h=this.getActualLength(f.length),k=h,l=this.shouldCopyValues()?new Array(h):this._values,m=!1,n=0;h>n;++n){var o=d(f[n],void 0);o instanceof b?o.isPending()?o._proxyPromiseArray(this,n):(o._unsetRejectionIsUnhandled(),m=!0):m=!0,l[n]=o}this._values=l,this._length=k,m&&this._scanDirectValues(h)},f.prototype._settlePromiseAt=function(a){var c=this._values[a];c instanceof b?c.isFulfilled()?this._promiseFulfilled(c._settledValue,a):c.isRejected()&&this._promiseRejected(c._settledValue,a):this._promiseFulfilled(c,a)},f.prototype._scanDirectValues=function(a){for(var b=0;a>b&&!this._isResolved();++b)this._settlePromiseAt(b)},f.prototype._isResolved=function(){return null===this._values},f.prototype._resolve=function(a){this._values=null,this._promise._fulfill(a)},f.prototype.__hardReject__=f.prototype._reject=function(a){this._values=null;var b=g(a)?a:new Error(a+"");this._promise._attachExtraTrace(b),this._promise._reject(a,b)},f.prototype._promiseProgressed=function(a,b){this._isResolved()||this._promise._progress({index:b,value:a})},f.prototype._promiseFulfilled=function(a,b){if(!this._isResolved()){this._values[b]=a;var c=++this._totalResolved;c>=this._length&&this._resolve(this._values)}},f.prototype._promiseRejected=function(a){this._isResolved()||(this._totalResolved++,this._reject(a))},f.prototype.shouldCopyValues=function(){return!0},f.prototype.getActualLength=function(a){return a},f}},{"./errors.js":10,"./util.js":35}],22:[function(a,b){"use strict";function c(a){return a instanceof Error&&n.getPrototypeOf(a)===Error.prototype}function d(a){var b;return b=c(a)?new k(a):a,i.markAsOriginatingFromRejection(b),b}function e(a){function b(b,c){if(null!==a){if(b){var e=d(h(b));a._attachExtraTrace(e),a._reject(e)}else if(arguments.length>2){for(var f=arguments.length,g=new Array(f-1),i=1;f>i;++i)g[i-1]=arguments[i];a._fulfill(g)}else a._fulfill(c);a=null}}return b}var f,g=a("./util.js"),h=g.maybeWrapAsError,i=a("./errors.js"),j=i.TimeoutError,k=i.OperationalError,l=a("./async.js"),m=g.haveGetters,n=a("./es5.js");if(f=m?function(a){this.promise=a}:function(a){this.promise=a,this.asCallback=e(a),this.callback=this.asCallback},m){var o={get:function(){return e(this.promise)}};n.defineProperty(f.prototype,"asCallback",o),n.defineProperty(f.prototype,"callback",o)}f._nodebackForPromise=e,f.prototype.toString=function(){return"[object PromiseResolver]"},f.prototype.resolve=f.prototype.fulfill=function(a){if(!(this instanceof f))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");var b=this.promise;b._tryFollow(a)||l.invoke(b._fulfill,b,a)},f.prototype.reject=function(a){if(!(this instanceof f))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");var b=this.promise;i.markAsOriginatingFromRejection(a);var c=i.canAttach(a)?a:new Error(a+"");b._attachExtraTrace(c),l.invoke(b._reject,b,a),c!==a&&l.invoke(this._setCarriedStackTrace,this,c)},f.prototype.progress=function(a){if(!(this instanceof f))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");l.invoke(this.promise._progress,this.promise,a)},f.prototype.cancel=function(){l.invoke(this.promise.cancel,this.promise,void 0)},f.prototype.timeout=function(){this.reject(new j("timeout"))},f.prototype.isResolved=function(){return this.promise.isResolved()},f.prototype.toJSON=function(){return this.promise.toJSON()},f.prototype._setCarriedStackTrace=function(a){this.promise.isRejected()&&this.promise._setCarriedStackTrace(a)},b.exports=f},{"./async.js":2,"./errors.js":10,"./es5.js":12,"./util.js":35}],23:[function(a,b){"use strict";b.exports=function(b,c){function d(a){return a.replace(/([$])/,"\\$")}function e(a){try{return a.__isPromisified__===!0}catch(b){return!1}}function f(a,b,c){var d=s.getDataPropertyOrDefault(a,b+c,A);return d?e(d):!1}function g(a,b,c){for(var d=0;d<a.length;d+=2){var e=a[d];if(c.test(e))for(var f=e.replace(c,""),g=0;g<a.length;g+=2)if(a[g]===f)throw new x("Cannot promisify an API that has normal methods with '"+b+"'-suffix")}}function h(a,b,c,d){for(var h=s.inheritedDataKeys(a),i=[],j=0;j<h.length;++j){var k=h[j],l=a[k];"function"!=typeof l||e(l)||f(a,k,b)||!d(k,l,a)||i.push(k,l)}return g(i,b,c),i}function i(a){for(var b=[a],c=Math.max(0,a-1-5),d=a-1;d>=c;--d)d!==a&&b.push(d);for(var d=a+1;5>=d;++d)b.push(d);return b}function j(a){return s.filledRange(a,"arguments[","]")}function k(a){return s.filledRange(a,"_arg","")}function l(a){return"number"==typeof a.length?Math.max(Math.min(a.length,1024),0):0}function m(a){return s.isIdentifier(a)?"."+a:"['"+a.replace(/(['\\])/g,"\\$1")+"']"}function n(a,d,e,f,g){function h(b){var c,e=j(b).join(", "),f=b>0?", ":"";return c="string"==typeof a?"                                                          \n                this.method(args, fn);                                       \n                break;                                                       \n            ".replace(".method",m(a)):d===r?"                                                         \n                callback.call(this, args, fn);                               \n                break;                                                       \n            ":void 0!==d?"                                                         \n                callback.call(receiver, args, fn);                           \n                break;                                                       \n            ":"                                                         \n                callback(args, fn);                                          \n                break;                                                       \n            ",c.replace("args",e).replace(", ",f)}function n(){for(var b="",c=0;c<p.length;++c)b+="case "+p[c]+":"+h(p[c]);var e;return e="string"==typeof a?"                                                  \n                this.property.apply(this, args);                             \n            ".replace(".property",m(a)):d===r?"                                                  \n                callback.apply(this, args);                                  \n            ":"                                                  \n                callback.apply(receiver, args);                              \n            ",b+="                                                             \n        default:                                                             \n            var args = new Array(len + 1);                                   \n            var i = 0;                                                       \n            for (var i = 0; i < len; ++i) {                                  \n               args[i] = arguments[i];                                       \n            }                                                                \n            args[i] = fn;                                                    \n            [CodeForCall]                                                    \n            break;                                                           \n        ".replace(/"[CodeForCall]"/,e)}var o=Math.max(0,l(f)-1),p=i(o),q="string"==typeof e&&s.isIdentifier(e)?e+g:"promisified";return new Function("Promise","callback","receiver","withAppended","maybeWrapAsError","nodebackForPromise","INTERNAL","                                         \n        var ret = function FunctionName(Parameters) {                        \n            'use strict';                                                    \n            var len = arguments.length;                                      \n            var promise = new Promise(INTERNAL);                             \n            promise._setTrace(void 0);                                       \n            var fn = nodebackForPromise(promise);                            \n            try {                                                            \n                switch(len) {                                                \n                    [CodeForSwitchCase]                                      \n                }                                                            \n            } catch (e) {                                                    \n                var wrapped = maybeWrapAsError(e);                           \n                promise._attachExtraTrace(wrapped);                          \n                promise._reject(wrapped);                                    \n            }                                                                \n            return promise;                                                  \n        };                                                                   \n        ret.__isPromisified__ = true;                                        \n        return ret;                                                          \n        ".replace("FunctionName",q).replace("Parameters",k(o)).replace("[CodeForSwitchCase]",n()))(b,a,d,u,v,t,c)}function o(a,d){function e(){var e=d;d===r&&(e=this),"string"==typeof a&&(a=e[a]);var f=new b(c);f._setTrace(void 0);var g=t(f);try{a.apply(e,u(arguments,g))}catch(h){var i=v(h);f._attachExtraTrace(i),f._reject(i)}return f}return e.__isPromisified__=!0,e}function p(a,b,c){for(var e=new RegExp(d(b)+"$"),f=h(a,b,e,c),g=0,i=f.length;i>g;g+=2){var j=f[g],k=f[g+1],l=j+b;a[l]=B(j,r,j,k,b)}return s.toFastProperties(a),a}function q(a,b){return B(a,b,void 0,a)}var r={},s=a("./util.js"),t=a("./promise_resolver.js")._nodebackForPromise,u=s.withAppended,v=s.maybeWrapAsError,w=s.canEvaluate,x=a("./errors").TypeError,y="Async",z=function(a,b){return s.isIdentifier(a)&&"_"!==a.charAt(0)&&!s.isClass(b)},A={__isPromisified__:!0},B=w?n:o;b.promisify=function(a,b){if("function"!=typeof a)throw new x("fn must be a function");return e(a)?a:q(a,arguments.length<2?r:b)},b.promisifyAll=function(a,b){if("function"!=typeof a&&"object"!=typeof a)throw new x("the target of promisifyAll must be an object or a function");var c=Object(b).suffix;"string"!=typeof c&&(c=y);var d=Object(b).filter;if("function"!=typeof d&&(d=z),!s.isIdentifier(c))throw new RangeError("suffix must be a valid identifier");for(var e=s.inheritedDataKeys(a,{includeHidden:!0}),f=0;f<e.length;++f){var g=a[e[f]];"constructor"!==e[f]&&s.isClass(g)&&(p(g.prototype,c,d),p(g,c,d))}return p(a,c,d)}}},{"./errors":10,"./promise_resolver.js":22,"./util.js":35}],24:[function(a,b){"use strict";b.exports=function(b,c,d){function e(a){for(var b=j.keys(a),c=b.length,d=new Array(2*c),e=0;c>e;++e){var f=b[e];d[e]=a[f],d[e+c]=f}this.constructor$(d)}function f(a){var c,f=d(a,void 0);return i(f)?(c=f instanceof b?f._then(b.props,void 0,void 0,void 0,void 0):new e(f).promise(),f instanceof b&&c._propagateFrom(f,4),c):h("cannot await properties of a non-object")}var g=a("./util.js"),h=a("./errors_api_rejection")(b),i=g.isObject,j=a("./es5.js");g.inherits(e,c),e.prototype._init=function(){this._init$(void 0,-3)},e.prototype._promiseFulfilled=function(a,b){if(!this._isResolved()){this._values[b]=a;var c=++this._totalResolved;if(c>=this._length){for(var d={},e=this.length(),f=0,g=this.length();g>f;++f)d[this._values[f+e]]=this._values[f];this._resolve(d)}}},e.prototype._promiseProgressed=function(a,b){this._isResolved()||this._promise._progress({key:this._values[b+this.length()],value:a})},e.prototype.shouldCopyValues=function(){return!1},e.prototype.getActualLength=function(a){return a>>1},b.prototype.props=function(){return f(this)},b.props=function(a){return f(a)}}},{"./errors_api_rejection":11,"./es5.js":12,"./util.js":35}],25:[function(a,b){"use strict";function c(a,b,c,d,e){for(var f=0;e>f;++f)c[f+d]=a[f+b]}function d(a){this._capacity=a,this._length=0,this._front=0,this._makeCapacity()}d.prototype._willBeOverCapacity=function(a){return this._capacity<a},d.prototype._pushOne=function(a){var b=this.length();this._checkCapacity(b+1);var c=this._front+b&this._capacity-1;this[c]=a,this._length=b+1},d.prototype.push=function(a,b,c){var d=this.length()+3;if(this._willBeOverCapacity(d))return this._pushOne(a),this._pushOne(b),void this._pushOne(c);var e=this._front+d-3;this._checkCapacity(d);var f=this._capacity-1;this[e+0&f]=a,this[e+1&f]=b,this[e+2&f]=c,this._length=d},d.prototype.shift=function(){var a=this._front,b=this[a];return this[a]=void 0,this._front=a+1&this._capacity-1,this._length--,b},d.prototype.length=function(){return this._length},d.prototype._makeCapacity=function(){for(var a=this._capacity,b=0;a>b;++b)this[b]=void 0},d.prototype._checkCapacity=function(a){this._capacity<a&&this._resizeTo(this._capacity<<3)},d.prototype._resizeTo=function(a){var b=this._front,d=this._capacity,e=new Array(d),f=this.length();if(c(this,0,e,0,d),this._capacity=a,this._makeCapacity(),this._front=0,d>=b+f)c(e,b,this,0,f);else{var g=f-(b+f&d-1);c(e,b,this,0,g),c(e,0,this,g,f-g)}},b.exports=d},{}],26:[function(a,b){"use strict";b.exports=function(b,c,d){function e(a,e){var j=d(a,void 0);if(j instanceof b)return h(j);if(!g(a))return f("expecting an array, a promise or a thenable");var k=new b(c);void 0!==e?k._propagateFrom(e,7):k._setTrace(void 0);for(var l=k._fulfill,m=k._reject,n=0,o=a.length;o>n;++n){var p=a[n];(void 0!==p||i.call(a,n))&&b.cast(p)._then(l,m,void 0,k,null)}return k}var f=a("./errors_api_rejection.js")(b),g=a("./util.js").isArray,h=function(a){return a.then(function(b){return e(b,a)})},i={}.hasOwnProperty;b.race=function(a){return e(a,void 0)},b.prototype.race=function(){return e(this,void 0)}}},{"./errors_api_rejection.js":11,"./util.js":35}],27:[function(a,b){"use strict";b.exports=function(b,c,d,e,f){function g(a,c,d,g){this.constructor$(a);var h=-2;this._preservedValues=g===f?[]:null;var i=e(d,void 0),j=!1,k=i instanceof b;k&&(i.isPending()?(h=-1,i._proxyPromiseArray(this,-1)):i.isFulfilled()?(d=i.value(),h=0):(i._unsetRejectionIsUnhandled(),this._reject(i.reason()),j=!0)),k||void 0===d||(h=0),this._callback=c,this._currentIndex=h,this._accum=d,j||this._init$(void 0,-5)}function h(a,b,c,e){if("function"!=typeof b)return d("fn must be a function");var f=new g(a,b,c,e);return f.promise()}var i=a("./util.js"),j=i.tryCatch4,k=i.tryCatch3,l=i.errorObj,m={};i.inherits(g,c),g.prototype._init=function(){},g.prototype._resolveEmptyArray=function(){-1!==this._currentIndex&&this._resolve(null!==this._preservedValues?[]:this._accum)},g.prototype._promiseFulfilled=function(a,c){var d,f=this._values;if(null!==f){var g=this.length(),h=this._currentIndex;if(!(h>c)){var i=this._preservedValues,n=null!==i;if(0===c&&-2===h){if(d=a,h=1,2>g)return this._resolve(void 0);a=f[1]}else{if(c>h)return;if(-1===c||f[c]===m){if(d=a,h++,h>=g)return this._resolve(n?i:d);a=f[h]}else d=this._accum}for(var o,p=this._callback,q=this._promise._boundTo,r=h;g>r;++r){if(r>h&&(a=f[r]),a instanceof b){if(!a.isFulfilled())return a.isPending()?(this._accum=d,void(this._currentIndex=r)):(a._unsetRejectionIsUnhandled(),this._reject(a.reason()));a=a._settledValue}if(n?(i.push(a),o=k(p,q,a,r,g)):o=j(p,q,d,a,r,g),o===l)return this._reject(o.e);var s=e(o,void 0);if(s instanceof b){if(s.isPending())return f[r]=m,this._accum=d,this._currentIndex=r,s._proxyPromiseArray(this,r);if(!s.isFulfilled())return s._unsetRejectionIsUnhandled(),this._reject(s.reason());o=s.value()}d=o}this._resolve(n?i:d)}}},b.prototype.reduce=function(a,b){return h(this,a,b,null)},b.reduce=function(a,b,c,d){return h(a,b,c,d)}}},{"./util.js":35}],28:[function(a,b){(function(a){"use strict";var c,d;if("object"==typeof a&&"string"==typeof a.version)c=function(b){a.nextTick(b)};else if("undefined"!=typeof MutationObserver&&(d=MutationObserver)||"undefined"!=typeof WebKitMutationObserver&&(d=WebKitMutationObserver))c=function(){var a=document.createElement("div"),b=void 0,c=new d(function(){var a=b;b=void 0,a()});return c.observe(a,{attributes:!0}),function(c){b=c,a.setAttribute("class","foo")}}();else{if("undefined"==typeof setTimeout)throw new Error("no async scheduler available");c=function(a){setTimeout(a,0)}}b.exports=c}).call(this,a("FWaASH"))},{FWaASH:36}],29:[function(a,b){"use strict";b.exports=function(b,c){function d(a){this.constructor$(a)}var e=b.PromiseInspection,f=a("./util.js");f.inherits(d,c),d.prototype._promiseResolved=function(a,b){this._values[a]=b;var c=++this._totalResolved;c>=this._length&&this._resolve(this._values)},d.prototype._promiseFulfilled=function(a,b){if(!this._isResolved()){var c=new e;c._bitField=268435456,c._settledValue=a,this._promiseResolved(b,c)}},d.prototype._promiseRejected=function(a,b){if(!this._isResolved()){var c=new e;c._bitField=134217728,c._settledValue=a,this._promiseResolved(b,c)}},b.settle=function(a){return new d(a).promise()},b.prototype.settle=function(){return new d(this).promise()}}},{"./util.js":35}],30:[function(a,b){"use strict";b.exports=function(b,c,d){function e(a){this.constructor$(a),this._howMany=0,this._unwrap=!1,this._initialized=!1}function f(a,b){if((0|b)!==b||0>b)return d("expecting a positive integer");var c=new e(a),f=c.promise();return f.isRejected()?f:(c.setHowMany(b),c.init(),f)}var g=a("./util.js"),h=a("./errors.js").RangeError,i=a("./errors.js").AggregateError,j=g.isArray;g.inherits(e,c),e.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-2);var a=j(this._values);if(!this._isResolved()&&a&&this._howMany>this._canPossiblyFulfill()){var b="(Promise.some) input array contains less than "+this._howMany+" promises";this._reject(new h(b))}}},e.prototype.init=function(){this._initialized=!0,this._init()},e.prototype.setUnwrap=function(){this._unwrap=!0},e.prototype.howMany=function(){return this._howMany},e.prototype.setHowMany=function(a){this._isResolved()||(this._howMany=a)},e.prototype._promiseFulfilled=function(a){this._isResolved()||(this._addFulfilled(a),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),this._resolve(1===this.howMany()&&this._unwrap?this._values[0]:this._values)))},e.prototype._promiseRejected=function(a){if(!this._isResolved()&&(this._addRejected(a),this.howMany()>this._canPossiblyFulfill())){for(var b=new i,c=this.length();c<this._values.length;++c)b.push(this._values[c]);this._reject(b)}},e.prototype._fulfilled=function(){return this._totalResolved},e.prototype._rejected=function(){return this._values.length-this.length()},e.prototype._addRejected=function(a){this._values.push(a)},e.prototype._addFulfilled=function(a){this._values[this._totalResolved++]=a},e.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},b.some=function(a,b){return f(a,b)},b.prototype.some=function(a){return f(this,a)},b._SomePromiseArray=e}},{"./errors.js":10,"./util.js":35}],31:[function(a,b){"use strict";b.exports=function(a){function b(a){void 0!==a?(this._bitField=a._bitField,this._settledValue=a.isResolved()?a._settledValue:void 0):(this._bitField=0,this._settledValue=void 0)}b.prototype.isFulfilled=a.prototype.isFulfilled=function(){return(268435456&this._bitField)>0},b.prototype.isRejected=a.prototype.isRejected=function(){return(134217728&this._bitField)>0},b.prototype.isPending=a.prototype.isPending=function(){return 0===(402653184&this._bitField)},b.prototype.value=a.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise");return this._settledValue},b.prototype.error=b.prototype.reason=a.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise");return this._settledValue},b.prototype.isResolved=a.prototype.isResolved=function(){return(402653184&this._bitField)>0},a.PromiseInspection=b}},{}],32:[function(a,b){"use strict";b.exports=function(b,c){function d(a){try{return a.then}catch(b){return j.e=b,j}}function e(a,e){if(k(a)){if(a instanceof b)return a;if(f(a)){var h=new b(c);return h._setTrace(void 0),a._then(h._fulfillUnchecked,h._rejectUncheckedCheckError,h._progressUnchecked,h,null),h._setFollowing(),h}var l=d(a);if(l===j)return void 0!==e&&i(l.e)&&e._attachExtraTrace(l.e),b.reject(l.e);if("function"==typeof l)return g(a,l,e)}return a}function f(a){return l.call(a,"_promise0")}function g(a,c,d){function e(c){if(!j){if(j=!0,a===c){var e=b._makeSelfResolutionError();return void 0!==d&&d._attachExtraTrace(e),void h.promise._reject(e,void 0)}h.resolve(c)}}function f(a){if(!j){j=!0;var b=i(a)?a:new Error(a+"");void 0!==d&&d._attachExtraTrace(b),h.promise._reject(a,b)}}function g(a){if(!j){var b=h.promise;"function"==typeof b._progress&&b._progress(a)}}var h=b.defer(),j=!1;try{c.call(a,e,f,g)}catch(k){if(!j){j=!0;var l=i(k)?k:new Error(k+"");void 0!==d&&d._attachExtraTrace(l),h.promise._reject(k,l)}}return h.promise}var h=a("./util.js"),i=a("./errors.js").canAttach,j=h.errorObj,k=h.isObject,l={}.hasOwnProperty;return e}},{"./errors.js":10,"./util.js":35}],33:[function(a,b){"use strict";var c=function(a,b){var c=arguments.length,d=arguments[2],e=arguments[3],f=c>=5?arguments[4]:void 0;setTimeout(function(){a(d,e,f)},b)};b.exports=function(b,d,e){var f=(a("./util.js"),a("./errors.js")),g=(a("./errors_api_rejection")(b),b.TimeoutError),h=function(a,b,c){if(a.isPending()){"string"!=typeof b&&(b="operation timed out after "+c+" ms");var d=new g(b);f.markAsOriginatingFromRejection(d),a._attachExtraTrace(d),a._cancel(d)}},i=function(a,b){b._fulfill(a)},j=b.delay=function(a,f){void 0===f&&(f=a,a=void 0),f=+f;var g=e(a,void 0),h=new b(d);return g instanceof b?(h._propagateFrom(g,7),h._follow(g),h.then(function(a){return b.delay(a,f)})):(h._setTrace(void 0),c(i,f,a,h),h)};b.prototype.delay=function(a){return j(this,a)},b.prototype.timeout=function(a,e){a=+a;var f=new b(d);return f._propagateFrom(this,7),f._follow(this),c(h,a,f,e,a),f.cancellable()}}},{"./errors.js":10,"./errors_api_rejection":11,"./util.js":35}],34:[function(a,b){"use strict";b.exports=function(b,c,d){function e(a){for(var c=a.length,d=0;c>d;++d){var e=a[d];if(e.isRejected())return b.reject(e.error());a[d]=e.value()}return a}function f(a){setTimeout(function(){throw a},0)}function g(a,c){function e(){if(g>=h)return i.resolve();var j=d(a[g++],void 0);if(j instanceof b&&j._isDisposable()){try{j=d(j._getDisposer().tryDispose(c),void 0)}catch(k){return f(k)}if(j instanceof b)return j._then(e,f,null,null,null)}e()}var g=0,h=a.length,i=b.defer();return e(),i.promise}function h(a){var b=new n;return b._settledValue=a,b._bitField=268435456,g(this,b).thenReturn(a)}function i(a){var b=new n;return b._settledValue=a,b._bitField=134217728,g(this,b).thenThrow(a)}function j(a,b){this._data=a,this._promise=b}function k(a,b){this.constructor$(a,b)}var l=a("./errors.js").TypeError,m=a("./util.js").inherits,n=b.PromiseInspection;j.prototype.data=function(){return this._data},j.prototype.promise=function(){return this._promise},j.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():null},j.prototype.tryDispose=function(a){var b=this.resource(),c=null!==b?this.doDispose(b,a):null;return this._promise._unsetDisposable(),this._data=this._promise=null,c},m(k,j),k.prototype.doDispose=function(a,b){var c=this.data();return c.call(a,a,b)},b.using=function(){var a=arguments.length;if(2>a)return c("you must pass at least 2 arguments to Promise.using");var d=arguments[a-1];if("function"!=typeof d)return c("fn must be a function");a--;for(var f=new Array(a),g=0;a>g;++g){var k=arguments[g];if(k instanceof j){var l=k;k=k.promise(),k._setDisposable(l)}f[g]=k}return b.settle(f).then(e).spread(d)._then(h,i,void 0,f,void 0)},b.prototype._setDisposable=function(a){this._bitField=262144|this._bitField,this._disposer=a},b.prototype._isDisposable=function(){return(262144&this._bitField)>0},b.prototype._getDisposer=function(){return this._disposer},b.prototype._unsetDisposable=function(){this._bitField=-262145&this._bitField,this._disposer=void 0},b.prototype.disposer=function(a){if("function"==typeof a)return new k(a,this);throw new l}}},{"./errors.js":10,"./util.js":35}],35:[function(a,b,c){"use strict";function d(a,b,c){try{return a.call(b,c)}catch(d){return x.e=d,x}}function e(a,b,c,d){try{return a.call(b,c,d)}catch(e){return x.e=e,x}}function f(a,b,c,d,e){try{return a.call(b,c,d,e)}catch(f){return x.e=f,x}}function g(a,b,c,d,e,f){try{return a.call(b,c,d,e,f)}catch(g){return x.e=g,x}}function h(a,b,c){try{return a.apply(c,b)}catch(d){return x.e=d,x}}function i(a){return"string"==typeof a?a:""+a}function j(a){return null==a||a===!0||a===!1||"string"==typeof a||"number"==typeof a}function k(a){return!j(a)}function l(a){return j(a)?new Error(i(a)):a}function m(a,b){var c,d=a.length,e=new Array(d+1);for(c=0;d>c;++c)e[c]=a[c];return e[c]=b,e}function n(a,b,c){if(!u.isES5)return{}.hasOwnProperty.call(a,b)?a[b]:void 0;var d=Object.getOwnPropertyDescriptor(a,b);return null!=d?null==d.get&&null==d.set?d.value:c:void 0
}function o(a,b,c){if(j(a))return a;var d={value:c,configurable:!0,enumerable:!1,writable:!0};return u.defineProperty(a,b,d),a}function p(a){throw a}function q(a){try{if("function"==typeof a){var b=u.keys(a.prototype);return b.length>0&&!(1===b.length&&"constructor"===b[0])}return!1}catch(c){return!1}}function r(a){function b(){}return b.prototype=a,b}function s(a){return B.test(a)}function t(a,b,c){for(var d=new Array(a),e=0;a>e;++e)d[e]=b+e+c;return d}var u=a("./es5.js"),v=function(){try{var a={};return u.defineProperty(a,"f",{get:function(){return 3}}),3===a.f}catch(b){return!1}}(),w="undefined"==typeof navigator,x={e:{}},y=function(a,b){function c(){this.constructor=a,this.constructor$=b;for(var c in b.prototype)d.call(b.prototype,c)&&"$"!==c.charAt(c.length-1)&&(this[c+"$"]=b.prototype[c])}var d={}.hasOwnProperty;return c.prototype=b.prototype,a.prototype=new c,a.prototype},z=function(){return"string"!==this}.call("string"),A=function(){return u.isES5?function(a,b){for(var c=[],d=Object.create(null),e=Object(b).includeHidden?Object.getOwnPropertyNames:Object.keys;null!=a;){var f;try{f=e(a)}catch(g){return c}for(var h=0;h<f.length;++h){var i=f[h];if(!d[i]){d[i]=!0;var j=Object.getOwnPropertyDescriptor(a,i);null!=j&&null==j.get&&null==j.set&&c.push(i)}}a=u.getPrototypeOf(a)}return c}:function(a){var b=[];for(var c in a)b.push(c);return b}}(),B=/^[a-z$_][a-z$_0-9]*$/i,C={isClass:q,isIdentifier:s,inheritedDataKeys:A,getDataPropertyOrDefault:n,thrower:p,isArray:u.isArray,haveGetters:v,notEnumerableProp:o,isPrimitive:j,isObject:k,canEvaluate:w,errorObj:x,tryCatch1:d,tryCatch2:e,tryCatch3:f,tryCatch4:g,tryCatchApply:h,inherits:y,withAppended:m,asString:i,maybeWrapAsError:l,wrapsPrimitiveReceiver:z,toFastProperties:r,filledRange:t};b.exports=C},{"./es5.js":12}],36:[function(a,b){function c(){}var d=b.exports={};d.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};if(b){var c=[];return window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),c.length>0)){var d=c.shift();d()}},!0),function(a){c.push(a),window.postMessage("process-tick","*")}}return function(a){setTimeout(a,0)}}(),d.title="browser",d.browser=!0,d.env={},d.argv=[],d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.binding=function(){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(){throw new Error("process.chdir is not supported")}},{}],37:[function(a,b){function c(a){if(!a||"[object Object]"!==e.call(a)||a.nodeType||a.setInterval)return!1;var b=d.call(a,"constructor"),c=d.call(a.constructor.prototype,"isPrototypeOf");if(a.constructor&&!b&&!c)return!1;var f;for(f in a);return void 0===f||d.call(a,f)}var d=Object.prototype.hasOwnProperty,e=Object.prototype.toString;b.exports=function f(){var a,b,d,e,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;for("boolean"==typeof i&&(l=i,i=arguments[1]||{},j=2),"object"!=typeof i&&"function"!=typeof i&&(i={});k>j;j++)if(null!=(a=arguments[j]))for(b in a)d=i[b],e=a[b],i!==e&&(l&&e&&(c(e)||(g=Array.isArray(e)))?(g?(g=!1,h=d&&Array.isArray(d)?d:[]):h=d&&c(d)?d:{},i[b]=f(l,h,e)):void 0!==e&&(i[b]=e));return i}},{}],38:[function(a,b){(function(c){function d(a){var b=this;if(!(b instanceof d))throw new Error("usage: new Hoodie(url);");b.baseUrl=a?a.replace(/\/+$/,""):"",b.extend=function(a){a(b,o,p)},b.extend(n),b.extend(h),b.extend(l),b.extend(j),b.extend(k),b.extend(f),b.extend(g),b.extend(i),b.extend(m),b.on("account:cleanup",p.config.clear),b.id.init(),b.account.username=p.config.get("_account.username"),b.remote.init(),b.account.checkPasswordReset(),b.store.bootstrapDirtyObjects(),b.account.subscribeToOutsideEvents(),b.id.subscribeToOutsideEvents(),b.store.subscribeToOutsideEvents(),b.remote.subscribeToOutsideEvents(),b.task.subscribeToOutsideEvents(),b.account.authenticate().then(function(){b.remote.connect()}),c.addEventListener("online",b.checkConnection,!1),c.addEventListener("offline",b.checkConnection,!1),b.checkConnection(),e(b)}function e(a){for(var b=0;b<q.length;b++)q[b](a,o,p)}var f=a("./hoodie/account"),g=a("./hoodie/remote"),h=a("./hoodie/connection"),i=a("./hoodie/id"),j=a("./hoodie/store"),k=a("./hoodie/task"),l=a("./hoodie/open"),m=a("./hoodie/request"),n=a("./lib/events"),o=a("./lib"),p=a("./utils"),q=[];d.extend=function(a){q.push(a)},b.exports=d}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./hoodie/account":39,"./hoodie/connection":40,"./hoodie/id":41,"./hoodie/open":42,"./hoodie/remote":43,"./hoodie/request":44,"./hoodie/store":45,"./hoodie/task":46,"./lib":52,"./lib/events":51,"./utils":62}],39:[function(a,b){(function(c){function d(a){function b(a){return h.set($,a)}function d(){return h.get($)}function n(){return h.unset($)}function o(){var b=a.id(),c=d();return W.signIn(b,c).done(function(){W.trigger("signin:anonymous",b)})}function p(){a.on("remote:error:unauthenticated",q)}function q(){return V=void 0,W.authenticate()}function r(a){return W.username!==a?(W.username=a,h.set("_account.username",a)):void 0}function s(a){return a.userCtx.name?(V=!0,m(W.username)):W.hasAnonymousAccount()?o():(V=!1,W.trigger("error:unauthenticated"),j())}function t(a,b){return function(c){return X._rev=c.rev,v(a,b)}}function u(a){return function(b){return"HoodieConflictError"===b.name&&(b.message="Username "+a+" already exists"),l(b)}}function v(a,b,d,e){return e||(e=i()),c.setTimeout(function(){var c=S(a,b,d);c.done(e.resolve),c.fail(function(c){"HoodieAccountUnconfirmedError"===c.name?v(a,b,d,e):e.reject.apply(e,arguments)})},300),e.promise()}function w(a){return a=a||{},function(b){var c,d;return c=b.name.replace(/^user(_anonymous)?\//,""),d=b.roles[0],-1!==b.roles.indexOf("error")?W.fetch(c).then(function(){return l(X.$error)}):-1===b.roles.indexOf("confirmed")?l({name:"HoodieAccountUnconfirmedError",message:"Account has not been confirmed yet"}):(V=!0,W.fetch(),m(c,d,a))}}function x(a){var b;return a.$error?(b=a.$error,b.object=a,delete b.object.$error):b={name:"HoodiePendingError",message:"Password reset is still pending"},l(b)}function y(a){return function(b){return"HoodieUnauthorizedError"===b.name?(h.unset("_account.resetPasswordId"),W.trigger("passwordreset",a),k()):l(b)}}function z(){var a=i();return W.one("passwordreset",a.resolve),W.on("error:passwordreset",A),W.on("error:passwordreset",a.reject),a.always(function(){W.unbind("passwordreset",a.resolve),W.unbind("error:passwordreset",A),W.unbind("error:passwordreset",a.reject)}),a.promise()}function A(a){var b=a.object,c=b.name,d=c.substr(15),e="/_users/"+encodeURIComponent(Z+":"+c),f=btoa(c+":"+d);b._deleted=!0;var g={headers:{Authorization:"Basic "+f},contentType:"application/json",data:JSON.stringify(b)};W.request("PUT",e,g),h.unset("_account.resetPasswordId")}function B(b,c,d){var e=W.hasAnonymousAccount()?a.id():W.username;return S(e,b).then(function(){return W.fetch().then(L(b,c,d))})}function C(a,b){var c=d();return B(c,a,b).done(function(){W.trigger("signup",a),n()})}function D(){return G(),X._deleted=!0,O("updateUsersDoc",function(){W.request("PUT",K(),{data:JSON.stringify(X),contentType:"application/json"})})}function E(a){return"HoodieNotFoundError"===a.name?k():l(a)}function F(){return W.trigger("cleanup"),V=void 0,r(void 0),k()}function G(){return a.remote.disconnect()}function H(){var a=W.username;return F().then(function(){return W.trigger("signout",a)})}function I(b){var c;return c=b===a.id()?"user_anonymous":"user",""+c+"/"+b}function J(b){var c=W.hasAnonymousAccount()?a.id():W.username;return b=b||c,""+Z+":"+I(b)}function K(a){return"/_users/"+encodeURIComponent(J(a))}function L(a,b,c){return function(){var d=f({},X);b&&(d.$newUsername=b),d.updatedAt=U(),d.signedUpAt=d.signedUpAt||U(),void 0!==c&&(delete d.salt,delete d.password_sha,d.password=c);var e={data:JSON.stringify(d),contentType:"application/json"};return O("updateUsersDoc",function(){return W.request("PUT",K(),e).then(M(b,c||a))})}}function M(b,c){var d=W.hasAnonymousAccount()?a.id():W.username;return function(){return G(),b?N(d,c).then(function(){return W.signOut({silent:!0,ignoreLocalChanges:!0}).then(function(){return W.signIn(b,c,{moveData:!0})})}):W.signIn(d,c)}}function N(a,b,d){d||(d=i());var e={data:{name:I(a),password:b}};return O("signIn",function(){return W.request("POST","/_session",e)}).done(function(){c.setTimeout(N,300,a,b,d)}).fail(function(a){return 401===a.status?d.resolve():void d.reject(a)}),d.promise()}function O(a,b){return void 0!==Y[a]&&"function"==typeof Y[a].abort&&Y[a].abort(),Y[a]=b(),Y[a]}function P(a,b){return void 0!==Y[a]&&"function"==typeof Y[a].state&&"pending"===Y[a].state()?Y[a]:(Y[a]=b(),Y[a])}function Q(b){return a.store.hasLocalChanges()&&!b.ignoreLocalChanges?a.remote.push():k()}function R(){return P("signOut",function(){return W.request("DELETE","/_session")})}function S(a,b,c){var d={data:{name:I(a),password:b}};return O("signIn",function(){var a=W.request("POST","/_session",d);return a.then(w(c))})}function T(b,c){var d,e=i();return b=b.toLowerCase(),d={data:JSON.stringify({_id:J(b),name:I(b),type:"user",roles:[],password:c,hoodieId:a.id(),database:W.db(),updatedAt:U(),createdAt:U(),signedUpAt:b!==a.id()?U():void 0}),contentType:"application/json"},W.request("PUT",K(b),d).done(e.notify).then(t(b,c),u(b)).then(e.resolve,e.reject),e.promise()}function U(){return new Date}var V,W={},X={},Y={},Z="org.couchdb.user";e(a,{context:W,namespace:"account"}),W.authenticate=function(){var a;return V===!1?j():V===!0?m(W.username):Y.signOut&&"pending"===Y.signOut.state()?Y.signOut.then(j):Y.signIn&&"pending"===Y.signIn.state()?Y.signIn:W.hasAccount()?(a=function(){return W.request("GET","/_session").then(s)},P("authenticate",a)):R().then(function(){return V=!1,j()})},W.hasValidSession=function(){return W.hasAccount()?V===!0:!1},W.hasInvalidSession=function(){return W.hasAccount()?V===!1:!1},W.signUp=function(a,b){return void 0===b&&(b=""),a?W.hasAnonymousAccount()?C(a,b):W.hasAccount()?l("Must sign out first."):T(a,b).done(function(){r(a),W.trigger("signup",a)}):l("Username must be set.")},W.anonymousSignUp=function(){var c,d;return c=g(10),d=a.id(),T(d,c).progress(function(){b(c)}).done(function(){W.trigger("signup:anonymous")})},W.hasAccount=function(){var a=!!W.username;return a||W.hasAnonymousAccount()},W.hasAnonymousAccount=function(){return!!d()};var $="_account.anonymousPassword";W.signIn=function(a,b,c){var d,e,f=a===W.username;return a||(a=""),b||(b=""),a=a.toLowerCase(),c=c||{},d=c.silent,e=!W.hasAccount()||f||c.moveData?S(a,b,c):Q(c).then(function(){return S(a,b,c)}),f||e.done(G),e.done(function(a,b){c.moveData&&(d||W.trigger("movedata")),f||c.moveData||F(),f?d||W.trigger("reauthenticated",a):r(a),d||W.trigger("signin",a,b,c)})},W.signOut=function(a){var b;return a=a||{},b=a.silent?F:H,W.hasAccount()?Q(a).then(G).then(R).then(b):b()},W.request=function(b,c,d){return d=d||{},a.request.apply(a,arguments)},W.db=function(){return"user/"+a.id()},W.fetch=function(b){var c=W.hasAnonymousAccount()?a.id():W.username;return void 0===b&&(b=c),b?P("fetch",function(){return W.request("GET",K(b)).done(function(a){return X=a})}):l({name:"HoodieUnauthorizedError",message:"Not signed in"})},W.changePassword=function(a,b){return W.username?(G(),W.fetch().then(L(a,null,b)).done(function(){W.trigger("changepassword")})):l({name:"HoodieUnauthorizedError",message:"Not signed in"})},W.resetPassword=function(a){var b,c,d,e;return(e=h.get("_account.resetPasswordId"))?W.checkPasswordReset():(e=""+a+"/"+g(),h.set("_account.resetPasswordId",e),c=""+Z+":$passwordReset/"+e,b={_id:c,name:"$passwordReset/"+e,type:"user",roles:[],password:e,createdAt:U(),updatedAt:U()},d={data:JSON.stringify(b),contentType:"application/json"},O("resetPassword",function(){return W.request("PUT","/_users/"+encodeURIComponent(c),d).done(W.checkPasswordReset).then(z).done(function(){W.trigger("resetpassword")})}))},W.checkPasswordReset=function(){var a,b,d,e,f,g;return(d=h.get("_account.resetPasswordId"))?(f=d.split("/")[0],g="$passwordReset/"+d,e="/_users/"+encodeURIComponent(Z+":"+g),a=btoa(g+":"+d),b={headers:{Authorization:"Basic "+a}},P("passwordResetStatus",function(){return W.request("GET",e,b).then(x,y(f)).fail(function(a){return"HoodiePendingError"===a.name?void c.setTimeout(W.checkPasswordReset,1e3):W.trigger("error:passwordreset",a,f)})})):l("No pending password reset.")},W.changeUsername=function(b,c){var d=W.hasAnonymousAccount()?a.id():W.username;return c!==d?(c=c||"",B(b,c.toLowerCase()).done(function(){r(c),W.trigger("changeusername",c)})):l({name:"HoodieConflictError",message:"Usernames identical"})},W.destroy=function(){return W.hasAccount()?W.fetch().then(D,E).then(H):H()},W.subscribeToOutsideEvents=function(){p(),delete W.subscribeToOutsideEvents},a.account=W}var e=a("../lib/events"),f=a("extend"),g=a("../utils/generate_id"),h=a("../utils/config"),i=a("../utils/promise/defer"),j=a("../utils/promise/reject"),k=a("../utils/promise/resolve"),l=a("../utils/promise/reject_with"),m=a("../utils/promise/resolve_with");b.exports=d}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../lib/events":51,"../utils/config":59,"../utils/generate_id":60,"../utils/promise/defer":64,"../utils/promise/reject":67,"../utils/promise/reject_with":68,"../utils/promise/resolve":69,"../utils/promise/resolve_with":70,extend:37}],40:[function(a,b){(function(c){function d(a){function b(){return h=3e4,j=c.setTimeout(a.checkConnection,h),a.isConnected()||(a.trigger("reconnected"),g=!0),f()}function d(){return h=3e3,j=c.setTimeout(a.checkConnection,h),a.isConnected()&&(a.trigger("disconnected"),g=!1),e()}var g=!0,h=3e4,i=null,j=null;a.checkConnection=function(){var e=i,f="/?hoodieId="+a.id();return e&&"pending"===e.state()?e:(c.clearTimeout(j),i=a.request("GET",f).then(b,d))},a.isConnected=function(){return g}}var e=a("../utils/promise/reject"),f=a("../utils/promise/resolve");b.exports=d}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../utils/promise/reject":67,"../utils/promise/resolve":69}],41:[function(a,b){function c(a){function b(){return i||c(d()),i}function c(a){i=a,e.set("_hoodieId",a)}function f(){i=void 0,e.unset("_hoodieId")}function g(){i=e.get("_hoodieId"),i||(i=e.get("_account.ownerHash"))}function h(){a.on("account:cleanup",f),a.on("account:signin",function(a,b){c(b)}),a.on("account:signin:anonymous",c)}var i;b.init=function(){g(),delete b.init},b.subscribeToOutsideEvents=function(){h(),delete b.subscribeToOutsideEvents},a.id=b}var d=a("../utils/generate_id"),e=a("../utils/config");b.exports=c},{"../utils/config":59,"../utils/generate_id":60}],42:[function(a,b){function c(a){function b(b,c){return c=c||{},e(c,{name:b}),d(a,c)}a.open=b}var d=a("../lib/store/remote"),e=a("extend");b.exports=c},{"../lib/store/remote":55,extend:37}],43:[function(a,b){function c(a){function b(a){return a?e.set("_remote.since",a):e.get("_remote.since")||0}function c(){a.on("remote:connect",function(){a.on("store:idle",d.push)}),a.on("remote:disconnect",function(){a.unbind("store:idle",d.push)}),a.on("disconnected",d.disconnect),a.on("reconnected",d.connect),a.on("account:signup",d.connect),a.on("account:signup:anonymous",d.connect),a.on("account:signin",d.connect),a.on("account:signin:anonymous",d.connect),a.on("account:reauthenticated",d.connect),a.on("account:signout",d.disconnect)}var d=a.open(a.account.db(),{connected:!0,prefix:"",since:b,defaultObjectsToPush:a.store.changedObjects,knownObjects:a.store.index().map(function(a){var b=a.split(/\//);return{type:b[0],id:b[1]}})}),g=d.connect;d.connect=function(){return a.account.hasAccount()?g(a.account.db()):f("User has no database to connect to")},d.trigger=function(){var b;b=arguments[0];var c=2<=arguments.length?Array.prototype.slice.call(arguments,1):[];return a.trigger.apply(a,["remote:"+b].concat(Array.prototype.slice.call(c)))},d.on=function(b,c){return b=b.replace(/(^| )([^ ]+)/g,"$1remote:$2"),a.on(b,c)},d.unbind=function(b,c){return b=b.replace(/(^| )([^ ]+)/g,"$1remote:$2"),a.unbind(b,c)},d.subscribeToOutsideEvents=function(){c(),delete d.subscribeToOutsideEvents},a.remote=d}function d(a){var b=function(){c(a)};a.remote={init:b}}var e=a("../utils/config"),f=a("../utils/promise/reject_with");b.exports=d},{"../utils/config":59,"../utils/promise/reject_with":68}],44:[function(a,b){function c(a){function b(b,d,f){var g,j,k;return f=f||{},g={type:b,dataType:"json"},/^http/.test(d)||(d=(a.baseUrl||"")+i+d),/^http/.test(d)&&(g.xhrFields={withCredentials:!0},g.crossDomain=!0),g.url=d,j=h(e(g,f)),k=j.then(null,c),k.abort=j.abort,k}function c(b){var c;try{c=g(b)}catch(d){c=b.responseText?b.responseText:{name:"HoodieConnectionError",message:"Could not connect to Hoodie server at {{url}}.",url:a.baseUrl||"/"}}return f(c)}function g(a){var b=JSON.parse(a.responseText);return b.name=j[a.status],b.name||(b.name=d(b.error)),b.status=a.status,b.message=b.reason||"",b.message=b.message.charAt(0).toUpperCase()+b.message.slice(1),delete b.error,delete b.reason,b}var h=$.ajax,i="/_api",j={400:"HoodieRequestError",401:"HoodieUnauthorizedError",403:"HoodieRequestError",404:"HoodieNotFoundError",409:"HoodieConflictError",412:"HoodieConflictError",500:"HoodieServerError"};a.request=b}var d=a("../utils/hoodiefy_request_error_name"),e=a("extend"),f=a("../utils/promise/reject_with");b.exports=c},{"../utils/hoodiefy_request_error_name":61,"../utils/promise/reject_with":68,extend:37}],45:[function(a,b){(function(c){function d(a){function b(a){if(f.isInvalid(a.type))return new f({type:a.type});if(a.id)return g.isInvalid(a.id)?new g({id:a.id}):void 0}function d(a,b,c,d){var e,f;if(void 0===c&&(c=!1),d=d||{},e=""+a+"/"+b,c){if(i(c,{type:a,id:b}),f=i({},c),delete f.type,delete f.id,m.setObject(e,f),d.remote)return q(a,b),H[e]=i(!0,{},c),H[e]}else{if(H[e]===!1)return!1;if(H[e])return i(!0,{},H[e]);if(e=""+a+"/"+b,c=m.getObject(e),!c)return q(a,b),H[e]=!1,!1;c.type=a,c.id=b}return y(c)?(p(a,b,c,d),H[e]=!1,!1):(H[e]=i(!0,{},c),x(c)?p(a,b,H[e],d):q(a,b),i(!0,{},c))}function n(){var a,b,c,e,f,g,h;if(b=m.getItem("_dirty"))for(b=b.split(","),f=0,g=b.length;g>f;f++)h=b[f].split("/"),e=h[0],a=h[1],c=d(e,a)}function o(){a.on("account:signup",r),a.on("account:movedata",F),a.on("account:cleanup",L.clear),a.on("remote:bootstrap:start",B),a.on("remote:bootstrap:end",C),a.on("remote:bootstrap:error",D),a.on("remote:change",s),a.on("remote:push",t)}function p(a,b,c,d){var e;d=d||{},e=""+a+"/"+b,I[e]=c,u(),d.silent||A()}function q(a,b){var d;return a&&b?(d=""+a+"/"+b,delete I[d]):I={},u(),c.clearTimeout(N)}function r(){return L.findAll().pipe(function(a){var b,c,d,e;for(d=0,e=a.length;e>d;d++)c=a[d],b=""+c.type+"/"+c.id,I[b]=c;u(),A()})}function s(a,b){"remove"===a?L.remove(b.type,b.id,{remote:!0,update:b}):L.save(b.type,b.id,b,{remote:!0})}function t(a){z("sync",a),a._deleted?L.remove(a.type,a.id,{remote:!0,silent:!0}):L.save(a.type,a.id,a,{remote:!0,silent:!0})}function u(){try{if($.isEmptyObject(I))m.removeItem("_dirty");else{var a=Object.keys(I);m.setItem("_dirty",a.join(","))}}catch(b){}}function v(){return JSON.stringify(new Date).replace(/['"]/g,"")}function w(a){return O.test(a)}function x(a){return a.updatedAt?a._syncedAt?a._syncedAt<a.updatedAt:!0:!1}function y(a){return a._deleted===!0}function z(a,b,c){L.trigger(a,i(!0,{},b),c),L.trigger(b.type+":"+a,i(!0,{},b),c),L.trigger(a+":"+b.type,i(!0,{},b),c),"new"!==a&&(L.trigger(b.type+":"+b.id+":"+a,i(!0,{},b),c),L.trigger(a+":"+b.type+":"+b.id,i(!0,{},b),c)),"sync"!==a&&(L.trigger("change",a,i(!0,{},b),c),L.trigger(b.type+":change",a,i(!0,{},b),c),L.trigger("change:"+b.type,a,i(!0,{},b),c),"new"!==a&&(L.trigger(b.type+":"+b.id+":change",a,i(!0,{},b),c),L.trigger("change:"+b.type+":"+b.id,a,i(!0,{},b),c)))}function A(){L.trigger("dirty"),c.clearTimeout(N),N=c.setTimeout(function(){L.trigger("idle",L.changedObjects())},K)}function B(){M=!0,L.trigger("bootstrap:start")}function C(){var a,b,c,d;for(M=!1;J.length>0;)a=J.shift(),b=a[0],c=a[1],d=a[2],G[b].apply(G,c).then(d.resolve,d.reject);L.trigger("bootstrap:end")}function D(a){var b,c;for(M=!1;J.length>0;)b=J.shift(),c=b[2],c.reject(a);L.trigger("bootstrap:error",a)}function E(a,b){var c=j();return J.push([a,b,c]),c.promise()}function F(){var b,c=[];L.findAll().done(function(e){c=e,c.length&&(b=a.id(),a.one("account:signin",function(a,e){c.forEach(function(a){a.createdBy===b&&(a.createdBy=e),a=d(a.type,a.id,a),p(a.type,a.id,a,{silent:!0})}),A()}))})}var G={},H={},I={},J=[],K=2e3;G.save=function(b,c){var e,f,g,i,k,l;if(c=c||{},L.isBootstrapping()&&!c.remote)return E("save",arguments);if(b.id?(e=d(b.type,b.id),k="object"!=typeof e):(k=!0,b.id=h()),k?b.createdBy=b.createdBy||a.id():e.createdBy&&(b.createdBy=e.createdBy),!k)for(l in e)if(!b.hasOwnProperty(l))switch(l.charAt(0)){case"_":c.remote&&(b[l]=e[l]);break;case"$":c.remote||(b[l]=e[l])}c.remote?b._syncedAt=v():c.silent||(b.updatedAt=v(),b.createdAt=b.createdAt||b.updatedAt),c.local?b._$local=!0:delete b._$local,f=j();try{b=d(b.type,b.id,b,c),f.resolve(b,k).promise(),i=k?"add":"update",c.silent||z(i,b,c)}catch(m){g=m,f.reject(g.toString())}return f.promise()},G.find=function(a,b){var c,e;if(L.isBootstrapping())return E("find",arguments);try{return e=d(a,b),e?l(e):k({name:"HoodieNotFoundError",message:'"{{type}}" with id "{{id}}" could not be found'})}catch(f){return c=f,k(c)}},G.findAll=function(a){var b,c,e,f,g,h,i,k,l;if(null==a&&(a=function(){return!0}),L.isBootstrapping())return E("findAll",arguments);h=L.index(),"string"==typeof a&&(l=a,a=function(a){return a.type===l}),c=j();try{k=function(){var c,e,j,k;for(k=[],c=0,e=h.length;e>c;c++)g=h[c],w(g)&&(j=g.split("/"),b=j[0],f=j[1],i=d(b,f),i&&a(i)&&k.push(i));return k}.call(this),k.sort(function(a,b){return a.createdAt>b.createdAt?-1:a.createdAt<b.createdAt?1:0}),c.resolve(k).promise()}catch(m){e=m,c.reject(e).promise()}return c.promise()},G.remove=function(a,b,c){var e,f,g;return c=c||{},L.isBootstrapping()&&!c.remote?E("remove",arguments):(e=a+"/"+b,f=d(a,b),c.update&&(f=c.update,delete c.update),c.remote&&(m.removeItem(e),g=H[e]&&y(H[e]),H[e]=!1,q(a,b),f)?(g||z("remove",f,c),l(f)):f?(f._syncedAt?(f._deleted=!0,d(a,b,f)):(e=a+"/"+b,m.removeItem(e),H[e]=!1,q(a,b)),z("remove",f,c),l(f)):k({name:"HoodieNotFoundError",message:'"{{type}}" with id "{{id}}"" could not be found'}))},G.removeAll=function(a,b){return L.findAll(a).then(function(a){var c,d,e,f;for(f=[],d=0,e=a.length;e>d;d++)c=a[d],f.push(L.remove(c.type,c.id,b));return f})};var L=e(a,{validate:b,backend:{save:G.save,find:G.find,findAll:G.findAll,remove:G.remove,removeAll:G.removeAll}});L.index=function(){var a,b,c,d,e;for(c=[],a=d=0,e=m.length();e>=0?e>d:d>e;a=e>=0?++d:--d)b=m.key(a),w(b)&&c.push(b);return c},L.changedObjects=function(){var a,b,c,d,e,f,g;e=I,g=[];for(b in e)e.hasOwnProperty(b)&&(c=e[b],f=b.split("/"),d=f[0],a=f[1],c.type=d,c.id=a,g.push(c));return g},L.hasLocalChanges=function(a,b){if(!a)return!$.isEmptyObject(I);var c=[a,b].join("/");return I[c]?!0:x(d(a,b))},L.clear=function(){var a,b,c,d;a=j();try{c=L.index(),d=function(){var a,d,e;for(e=[],a=0,d=c.length;d>a;a++)b=c[a],w(b)&&e.push(m.removeItem(b));return e}.call(this),H={},q(),a.resolve(),L.trigger("clear")}catch(e){a.reject(e)}return a.promise()};var M=!1;L.isBootstrapping=function(){return M},L.isPersistent=function(){return m.isPersistent},L.subscribeToOutsideEvents=function(){o(),delete L.subscribeToOutsideEvents};var N,O=new RegExp(/^[a-z$][a-z0-9]+\/[a-z0-9]+$/);a.store=L,L.bootstrapDirtyObjects=function(){n(),delete L.bootstrapDirtyObjects}}var e=a("../lib/store/api"),f=a("../lib/error/object_type"),g=a("../lib/error/object_id"),h=a("../utils/generate_id"),i=a("extend"),j=a("../utils/promise/defer"),k=a("../utils/promise/reject_with"),l=a("../utils/promise/resolve_with"),m=a("../utils/local_storage_wrapper");b.exports=d}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../lib/error/object_id":49,"../lib/error/object_type":50,"../lib/store/api":53,"../utils/generate_id":60,"../utils/local_storage_wrapper":63,"../utils/promise/defer":64,"../utils/promise/reject_with":68,"../utils/promise/resolve_with":70,extend:37}],46:[function(a,b){function c(a){function b(){a.on("store:change",j)}function c(b){var c=h(),d=a.store(b.type,b.id);return d.on("remove",function(a){return a.type=a.type.substr(1),a.$processedAt?c.resolve(a):void c.reject(new f({message:"Task has been aborted",task:a}))}),d.on("update",function(b){var d=b.$error;b.$error&&(b.type=b.type.substr(1),delete b.$error,d.object=b,d.message=d.message||"Something went wrong",c.reject(new f(d)),a.store.remove("$"+b.type,b.id))}),c.promise()}function i(b){var c,d=b.type,e=b.id,f=a.store.remove(d,e);return b._rev?(c=h(),a.one("store:sync:"+d+":"+e,c.resolve),f.fail(c.reject),c.promise()):f}function j(a,b,c){"$"===b.type[0]&&(b.type=b.type.substr(1),n(a,b,c))}function k(b){var c,d="$";return b&&(d+=b),c=function(a){return 0===a.type.indexOf(d)},a.store.findAll(c)}function l(a){return a.map(function(a){return p.abort(a.type.substr(1),a.id)})}function m(a,b){return a.map(function(a){return p.restart(a.type.substr(1),a.id,b)})}function n(a,b,c){var d;return"add"===a&&(a="start"),"remove"===a&&b.abortedAt&&(a="abort"),"remove"===a&&b.$processedAt&&!b.$error&&(a="success"),"update"===a&&b.$error?(a="error",d=b.$error,delete b.$error,p.trigger("error",d,b,c),p.trigger(b.type+":error",d,b,c),p.trigger(b.type+":"+b.id+":error",d,b,c),c=g({},c,{error:d}),p.trigger("change","error",b,c),p.trigger(b.type+":change","error",b,c),void p.trigger(b.type+":"+b.id+":change","error",b,c)):void(("start"===a||"abort"===a||"success"===a)&&(p.trigger(a,b,c),p.trigger(b.type+":"+a,b,c),"start"!==a&&p.trigger(b.type+":"+b.id+":"+a,b,c),p.trigger("change",a,b,c),p.trigger(b.type+":change",a,b,c),"start"!==a&&p.trigger(b.type+":"+b.id+":change",a,b,c)))}function o(){return JSON.stringify(new Date).replace(/['"]/g,"")}var p=function q(b,c){return e(a,q,{type:b,id:c})};d(a,{context:p,namespace:"task"}),p.start=function(b,d){return a.account.hasAccount()?a.store.add("$"+b,d).then(c):a.account.anonymousSignUp().then(function(){return p.start(b,d)})},p.abort=function(b,c){return a.store.update("$"+b,c,{abortedAt:o()}).then(i)},p.restart=function(a,b,c){var d=function(a){return g(a,c),delete a.$error,delete a.$processedAt,delete a.abortedAt,p.start(a.type,a)};return p.abort(a,b).then(d)},p.abortAll=function(a){return k(a).then(l)},p.restartAll=function(a,b){return"object"==typeof a&&(b=a),k(a).then(function(a){m(a,b)})},p.subscribeToOutsideEvents=function(){b(),delete p.subscribeToOutsideEvents},a.task=p}var d=a("../lib/events"),e=a("../lib/task/scoped"),f=a("../lib/error/error"),g=a("extend"),h=a("../utils/promise/defer");b.exports=c},{"../lib/error/error":47,"../lib/events":51,"../lib/task/scoped":58,"../utils/promise/defer":64,extend:37}],47:[function(a,b){function c(a){"string"==typeof a&&(a={message:a}),a.message||(a.message="Something went wrong"),a.name||(a.name="HoodieError"),a.message=a.message.replace(d,function(b){var c=b.match(e)[0];return a[c]}),f(this,a)}var d=/\{\{\s*\w+\s*\}\}/g,e=/\w+/,f=a("extend");c.prototype=new Error,c.prototype.constructor=c,b.exports=c},{extend:37}],48:[function(a,b){b.exports={error:a("./error"),objectId:a("./object_id"),objectType:a("./object_type")}},{"./error":47,"./object_id":49,"./object_type":50}],49:[function(a,b){function c(a){return a.name="HoodieObjectIdError",a.message='"{{id}}" is invalid object id. {{rules}}.',new d(a)}var d=a("./error"),e=/^[a-z0-9\-]+$/;c.isInvalid=function(a,b){return!(b||e).test(a||"")},c.isValid=function(a,b){return(b||e).test(a||"")},c.prototype.rules="Lowercase letters, numbers and dashes allowed only. Must start with a letter",b.exports=c},{"./error":47}],50:[function(a,b){function c(a){return a.name="HoodieObjectTypeError",a.message='"{{type}}" is invalid object type. {{rules}}.',new d(a)}var d=a("./error"),e=/^[a-z$][a-z0-9]+$/;c.isInvalid=function(a,b){return!(b||e).test(a||"")},c.isValid=function(a,b){return(b||e).test(a||"")},c.prototype.rules="lowercase letters, numbers and dashes allowed only. Must start with a letter",b.exports=c},{"./error":47}],51:[function(a,b){function c(a,b){function c(b,c){var d,e,f,g;for(d=b.split(" "),f=0,g=d.length;g>f;f++)e=h+d[f],a.eventsCallbacks[e]=a.eventsCallbacks[e]||[],a.eventsCallbacks[e].push(c)}function d(b,c){b=h+b;var d=function(){a.unbind(b,d),c.apply(null,arguments)};a.bind(b,d)}function e(){var b,c,d,e,f,g;if(b=1<=arguments.length?Array.prototype.slice.call(arguments,0):[],d=b.shift(),d=h+d,e=a.eventsCallbacks[d]){for(f=0,g=e.length;g>f;f++)c=e[f],c.apply(null,b);return!0}}function f(b,c){var d,e,f,g,i,j;if(!b)return h||(a.eventsCallbacks={}),j=Object.keys(a.eventsCallbacks),j=j.filter(function(a){return 0===a.indexOf(h)}),void j.forEach(function(b){delete a.eventsCallbacks[b]});if(b=h+b,f=a.eventsCallbacks[b]){if(!c)return void delete a.eventsCallbacks[b];for(e=g=0,i=f.length;i>g;e=++g)if(d=f[e],d===c){f=f.slice(),f.splice(e,1),a.eventsCallbacks[b]=f;break}}}var g=a,h="";b=b||{},a.eventsCallbacks||(a.eventsCallbacks={}),b.context&&(g=b.context,h=b.namespace+":"),g.bind=c,g.on=c,g.one=d,g.trigger=e,g.unbind=f,g.off=f}b.exports=c},{}],52:[function(a,b){b.exports={error:a("./error"),events:a("./events"),store:a("./store"),task:a("./task")}},{"./error":48,"./events":51,"./store":54,"./task":57}],53:[function(a,b){function c(a,b){function c(a){return i(a,o)}var n={},o={hoodie:a},p=b.name||"store",q=function u(c,e){var f=i(!0,{type:c,id:e},b);return d(a,u,f)};if(e(a,{context:q,namespace:p}),q.validate=b.validate,b.validate||(q.validate=function(a){if(!a)return new f({name:"InvalidObjectError",message:"No object passed."});if(g.isInvalid(a.type,s))return new g({type:a.type,rules:t});if(a.id)return h.isInvalid(a.id,s)?new h({id:a.id,rules:t}):void 0}),q.save=function(a,b,d,e){e=e?i(!0,{},e):{};var f=i(!0,{},d,{type:a,id:b}),g=q.validate(f,e||{});return g?k(g):c(n.save(f,e||{}))},q.add=function(a,b,c){return void 0===b&&(b={}),c=c||{},q.save(a,b.id,b,c)},q.find=function(a,b){return c(n.find(a,b))},q.findOrAdd=function(a,b,d){function e(){var c;return c=i(!0,{id:b},d),q.add(a,c)}null===d&&(d={});var f=q.find(a,b).then(null,e);return c(f)},q.findAll=function(a,b){return c(n.findAll(a,b))},q.update=function(a,b,d,e){function f(c){var f,g,h;return g=i(!0,{},c),"function"==typeof d&&(d=d(g)),d?(f=function(){var a=[];for(var b in d)if(d.hasOwnProperty(b)){if(h=d[b],c[b]===h)continue;g[b]=h,a.push(b)}return a}(),f.length||e?q.save(a,b,g,e):l(g)):l(c)}var g=q.find(a,b).then(f);return c(g)},q.updateOrAdd=function(a,b,d,e){function f(){var c=i(!0,{},d,{id:b});return q.add(a,c,e)}var g=q.update(a,b,d,e).then(null,f);return c(g)},q.updateAll=function(a,b,d){var e;switch(d=d||{},!0){case"string"==typeof a:e=q.findAll(a);break;case m(a):e=a;break;case $.isArray(a):e=j().resolve(a).promise();break;default:e=q.findAll()}return e=e.then(function(a){var c,e;return $.isArray(a)||(a=[a]),e=function(){var e,f,g;for(g=[],e=0,f=a.length;f>e;e++)c=a[e],g.push(q.update(c.type,c.id,b,d));return g}(),$.when.apply(null,e)}),c(e)},q.remove=function(a,b,d){return c(n.remove(a,b,d||{}))},q.removeAll=function(a,b){return c(n.removeAll(a,b||{}))},q.decoratePromises=function(a){return i(o,a)},!b.backend)throw new Error("options.backend must be passed");var r="save find findAll remove removeAll".split(" ");r.forEach(function(a){if(!b.backend[a])throw new Error("options.backend."+a+" must be passed.");n[a]=b.backend[a]});var s=/^[^\/]+$/,t="/ not allowed";return q}var d=a("./scoped"),e=a("../events"),f=a("../error/error"),g=a("../error/object_type"),h=a("../error/object_id"),i=a("extend"),j=a("../../utils/promise/defer"),k=a("../../utils/promise/reject_with"),l=a("../../utils/promise/resolve_with"),m=a("../../utils/promise/is_promise");
b.exports=c},{"../../utils/promise/defer":64,"../../utils/promise/is_promise":66,"../../utils/promise/reject_with":68,"../../utils/promise/resolve_with":70,"../error/error":47,"../error/object_id":49,"../error/object_type":50,"../events":51,"./scoped":56,extend:37}],54:[function(a,b){b.exports={api:a("./api"),remote:a("./remote"),scoped:a("./scoped")}},{"./api":53,"./remote":55,"./scoped":56}],55:[function(a,b){(function(c){function d(a,b){function d(a){return"function"==typeof z?z(a):z=a}function i(a){var b,c;c=f({},a);for(b in c)if(c.hasOwnProperty(b)){if(-1!==G.indexOf(b))continue;if(!/^_/.test(b))continue;delete c[b]}return c._id=""+c.type+"/"+c.id,w.prefix&&(c._id=""+w.prefix+c._id),delete c.id,c}function j(a){var b,c;return b=a._id||a.id,delete a._id,w.prefix&&(b=b.replace(y,"")),c=b.match(/([^\/]+)\/(.*)/),a.type=c[1],a.id=c[2],a}function k(a){return a.map(j)}function l(a){var b,c,d,e;try{e=a._rev.split(/-/),c=e[0],b=e[1]}catch(f){}return c=parseInt(c,10)||0,d=m(),a._$local&&(d+="-local"),a._rev=""+(c+1)+"-"+d,a._revisions={start:1,ids:[d]},b?(a._revisions.start+=c,a._revisions.ids.push(b)):void 0}function m(){return g(9)}function n(a){return a.rows.map(function(a){return a.doc})}function o(){var a;return a=w.getSinceNr(),w.isConnected()&&!A?"/_changes?include_docs=true&since="+a+"&heartbeat=10000&feed=longpoll":"/_changes?include_docs=true&since="+a}function p(){B&&B.abort()}function q(a){return d(a.last_seq),u(a.results),w.isConnected()?w.pull():void 0}function r(b,d){if(w.isConnected())switch(b.status){case 401:return w.trigger("error:unauthenticated",d),w.disconnect();case 404:return c.setTimeout(w.pull,3e3);case 500:return w.trigger("error:server",d),c.setTimeout(w.pull,3e3),a.checkConnection();default:return"abort"===b.statusText?w.pull():(c.setTimeout(w.pull,3e3),a.checkConnection())}}function s(){A=!1,w.trigger("bootstrap:end")}function t(a){A=!1,w.trigger("bootstrap:error",a)}function u(a){for(var b,c,d,e=0;e<a.length;e++)if(b=a[e].doc,!(w.prefix&&0!==b._id.indexOf(w.prefix)||E[b._rev])){if(d=j(b),d._deleted){if(!w.isKnownObject(d))continue;c="remove",w.isKnownObject(d)}else w.isKnownObject(d)?c="update":(c="add",w.markAsKnownObject(d));w.trigger(c,d),w.trigger(d.type+":"+c,d),w.trigger(d.type+":"+d.id+":"+c,d),w.trigger("change",c,d),w.trigger(d.type+":change",c,d),w.trigger(d.type+":"+d.id+":change",c,d),w.trigger(c+":"+d.type,d),w.trigger(c+":"+d.type+":"+d.id,d),w.trigger("change:"+d.type,c,d),w.trigger("change:"+d.type+":"+d.id,c,d)}E={}}var v={};v.find=function(a,b){var c;return c=a+"/"+b,w.prefix&&(c=w.prefix+c),c="/"+encodeURIComponent(c),w.request("GET",c).then(j)},v.findAll=function(a){var b,c,d;switch(c="/_all_docs?include_docs=true",!0){case void 0!==a&&""!==w.prefix:d=w.prefix+a+"/";break;case void 0!==a:d=a+"/";break;case""!==w.prefix:d=w.prefix;break;default:d=""}return d&&(b=d.replace(/.$/,function(a){var b;return b=a.charCodeAt(0),String.fromCharCode(b+1)}),c=""+c+'&startkey="'+encodeURIComponent(d)+'"&endkey="'+encodeURIComponent(b)+'"'),w.request("GET",c).then(n).then(k)},v.save=function(a){var b;return a.id||(a.id=g()),a=i(a),b="/"+encodeURIComponent(a._id),w.request("PUT",b,{data:a})},v.remove=function(a,b){return w.update(a,b,{_deleted:!0})},v.removeAll=function(a){return w.updateAll(a,{_deleted:!0})};var w=e(a,{name:b.name,backend:{save:v.save,find:v.find,findAll:v.findAll,remove:v.remove,removeAll:v.removeAll}}),x=null;w.connected=!1,w.prefix="";var y=new RegExp("^");void 0!==b.name&&(x=b.name),void 0!==b.prefix&&(w.prefix=b.prefix,y=new RegExp("^"+w.prefix)),null!==b.baseUrl&&(w.baseUrl=b.baseUrl),w.request=function(b,c,d){return d=d||{},x&&(c="/"+encodeURIComponent(x)+c),w.baseUrl&&(c=""+w.baseUrl+c),d.contentType=d.contentType||"application/json",("POST"===b||"PUT"===b)&&(d.dataType=d.dataType||"json",d.processData=d.processData||!1,d.data=JSON.stringify(d.data)),a.request(b,c,d)},w.isKnownObject=function(a){var b=""+a.type+"/"+a.id;return void 0!==F[b]?F[b]:void 0},w.markAsKnownObject=function(a){var b=""+a.type+"/"+a.id;return F[b]=1,F[b]},w.connect=function(a){return a&&(x=a),w.connected=!0,w.trigger("connect"),w.bootstrap().then(function(){w.push()})},w.disconnect=function(){w.connected=!1,w.trigger("disconnect"),B&&B.abort(),D&&D.abort()},w.isConnected=function(){return w.connected};var z=b.since||0;w.getSinceNr=function(){return"function"==typeof z?z():z};var A=!1;w.bootstrap=function(){return A=!0,w.trigger("bootstrap:start"),w.pull().done(s).fail(t)};var B,C;w.pull=function(){return B=w.request("GET",o()),w.isConnected()&&(c.clearTimeout(C),C=c.setTimeout(p,25e3)),B.done(q).fail(r)};var D,E={};w.push=function(a){var b,c=[];if($.isArray(a)||(a=H()),0===a.length)return h([]);a=a.map(function(a){return f(!0,{},a)}),c=[];for(var d=0;d<a.length;d++)b=a[d],l(b),w.markAsKnownObject(b),b=i(b),c.push(b),E[b._rev]=1;return D=w.request("POST","/_bulk_docs",{data:{docs:c,new_edits:!1}}),D.done(function(){for(var b=0;b<a.length;b++)delete a[b]._revisions,w.trigger("push",a[b])}),D},w.sync=function(a){return w.push(a).then(w.pull)};var F={},G=["_id","_rev","_deleted","_revisions","_attachments"],H=function(){return[]};if(b.defaultObjectsToPush&&(H=$.isArray(b.defaultObjectsToPush)?function(){return b.defaultObjectsToPush}:b.defaultObjectsToPush),b.knownObjects)for(var I=0;I<b.knownObjects.length;I++)w.markAsKnownObject({type:b.knownObjects[I].type,id:b.knownObjects[I].id});return w}var e=a("./api"),f=a("extend"),g=a("../../utils/generate_id"),h=a("../../utils/promise/resolve_with");b.exports=d}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/generate_id":60,"../../utils/promise/resolve_with":70,"./api":53,extend:37}],56:[function(a,b){function c(a,b,c){var e=c.name||"store",f=c.type,g=c.id,h={};return g||(d(a,{context:h,namespace:e+":"+f}),h.save=function(a,c,d){return b.save(f,a,c,d)},h.add=function(a,c){return b.add(f,a,c)},h.find=function(a){return b.find(f,a)},h.findOrAdd=function(a,c){return b.findOrAdd(f,a,c)},h.findAll=function(a){return b.findAll(f,a)},h.update=function(a,c,d){return b.update(f,a,c,d)},h.updateAll=function(a,c){return b.updateAll(f,a,c)},h.remove=function(a,c){return b.remove(f,a,c)},h.removeAll=function(a){return b.removeAll(f,a)}),g&&(d(a,{context:h,namespace:e+":"+f+":"+g}),h.save=function(a,c){return b.save(f,g,a,c)},h.find=function(){return b.find(f,g)},h.update=function(a,c){return b.update(f,g,a,c)},h.remove=function(a){return b.remove(f,g,a)}),h.decoratePromises=b.decoratePromises,h.validate=b.validate,h}var d=a("../events");b.exports=c},{"../events":51}],57:[function(a,b){b.exports={scoped:a("./scoped")}},{"./scoped":58}],58:[function(a,b){function c(a,b,c){var e=c.type,f=c.id,g={};return f||(d(a,{context:g,namespace:"task:"+e}),g.start=function(a){return b.start(e,a)},g.abort=function(a){return b.abort(e,a)},g.restart=function(a,c){return b.restart(e,a,c)},g.abortAll=function(){return b.abortAll(e)},g.restartAll=function(a){return b.restartAll(e,a)}),f&&(d(a,{context:g,namespace:"task:"+e+":"+f}),g.abort=function(){return b.abort(e,f)},g.restart=function(a){return b.restart(e,f,a)}),g}var d=a("../events");b.exports=c},{"../events":51}],59:[function(a,b){function c(){d=e.getObject(h)||{}}var d,e=a("../utils/local_storage_wrapper"),f=a("extend"),g={},h="_hoodie_config";g.set=function(a,b){d[a]=b,e.setObject(h,d)},g.get=function(a){return a?d[a]:f({},d)},g.clear=function(){return d={},e.removeItem(h)},g.unset=function(a){delete d[a],e.setObject(h,d)},c(),b.exports=g},{"../utils/local_storage_wrapper":63,extend:37}],60:[function(a,b){var c="0123456789abcdefghijklmnopqrstuvwxyz".split(""),d=c.length;b.exports=function(a){var b,e="";for(void 0===a&&(a=7),b=0;a>b;b++){var f=Math.random()*d,g=c[Math.floor(f)];e+=String(g).charAt(0)}return e}},{}],61:[function(a,b){function c(a){return a=a.replace(d,function(a){return(a[1]||a[0]).toUpperCase()}),"Hoodie"+a+"Error"}var d=/(^\w|_\w)/g;b.exports=c},{}],62:[function(a,b){b.exports={config:a("./config"),generateId:a("./generate_id"),localStorageWrapper:a("./local_storage_wrapper"),promise:a("./promise")}},{"./config":59,"./generate_id":60,"./local_storage_wrapper":63,"./promise":65}],63:[function(a,b){(function(a){function c(){e.isPersistent=d(),e.isPersistent||(e.getItem=function(){return null},e.setItem=function(){return null},e.removeItem=function(){return null},e.key=function(){return null},e.length=function(){return 0},e.isPersistent=function(){return!1})}function d(){try{if(!a.localStorage)return!1;if(localStorage.setItem("Storage-Test","1"),"1"!==localStorage.getItem("Storage-Test"))return!1;localStorage.removeItem("Storage-Test")}catch(b){return!1}return!0}var e={};e.setItem=function(b,c){a.localStorage.setItem(b,c)},e.getItem=function(b){return a.localStorage.getItem(b)},e.removeItem=function(b){return a.localStorage.removeItem(b)},e.clear=function(){return a.localStorage.clear()},e.key=function(b){return a.localStorage.key(b)},e.length=function(){return a.localStorage.length},e.setObject=function(b,c){return"object"!=typeof c?e.setItem(b,c):e.setItem(b,a.JSON.stringify(c))},e.getObject=function(b){var c=e.getItem(b);if(!c)return null;try{return a.JSON.parse(c)}catch(d){return c}},c(),b.exports=e}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],64:[function(a,b,c){(function(d){c.Promise="function"==typeof d.Promise?d.Promise:a("bluebird");var e=c.Promise;b.exports=function(){var a,b,c;return c=new e(function(){a=arguments[0],b=arguments[1]}),{resolve:a,reject:b,promise:c}}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{bluebird:3}],65:[function(a,b){b.exports={defer:a("./defer"),isPromise:a("./is_promise"),rejectWith:a("./reject_with"),reject:a("./reject"),resolveWith:a("./resolve_with"),resolve:a("./resolve")}},{"./defer":64,"./is_promise":66,"./reject":67,"./reject_with":68,"./resolve":69,"./resolve_with":70}],66:[function(a,b){b.exports=function(a){return"function"==typeof a.then}},{}],67:[function(a,b){var c=a("./defer");b.exports=function(){var a=c();return a.reject(),a.promise}},{"./defer":64}],68:[function(a,b){var c=a("./defer"),d=a("../../lib/error/error");b.exports=function(a){var b=new d(a),e=c();return e.reject(b),e.promise}},{"../../lib/error/error":47,"./defer":64}],69:[function(a,b){var c=a("./defer");b.exports=function(){var a=c();return a.resolve(),a.promise}},{"./defer":64}],70:[function(a,b){var c=a("./defer");b.exports=function(){var a=c();return a.resolve.apply(a,arguments),a.promise}},{"./defer":64}]},{},[38])(38)});